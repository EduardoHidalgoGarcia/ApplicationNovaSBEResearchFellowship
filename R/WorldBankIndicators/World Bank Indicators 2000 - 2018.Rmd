---
title: "World Bank Indicators 2000 - 2018"
author: "Eduardo Hidalgo, eduardohidalgogarcia@gmail.com"
header-includes:
   - \usepackage{bbm}
   - \usepackage[utf8]{inputenc}
   - \usepackage{amsmath}
   - \usepackage[T1]{fontenc}
   - \usepackage{upgreek}
   - \usepackage{mathtools}
   - \usepackage{textcomp}
   - \DeclareUnicodeCharacter{2212}{-}


abstract: "This document aims to consolidate available indicators as a *sandbox* tool for next analyses. I make use of the available data to ask about inequality and development. If one were to be  borned among the poorest 10th percent of population what is preferable: 1) To live in a country where the income share held by the lowest 10 percent is similar to the countries of europe with a GDP to population proportion as the one held by countries in latin america? 2) Or to live in a country with a GDP to population proportion similar to the United States and an income share held by the lowest 10 percent similar to the latin amercan countries? GDP & GNI per Capita estimations, presented on a section with the same name, were constructed to address these questions. In section GDP and Population I make use of available data to develop a simple model based on normal distribution for GDP and Population growth rates using mean and standard deviations for the current century. The simple model has two baseline scenarios, one with no population growth and the other with both GDP and Population growth rates equal to the averages of the same period. In each section it is possible to compare among countries of the OCDE plus the economies of Brazil and China."
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  pdf_document:
    toc: true
    toc_depth: 3
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(readxl)
#install.packages("deSolve")
library(deSolve)
#install.packages("data.table")
library(data.table)
library(reshape2)
library(tidyverse)
library(plyr)
#install.packages("gmodels")
library(gmodels)
library(scales)
library(grid)
library(gridExtra)
#install.packages("captioner")
table_captions <- captioner::captioner(prefix="Table")
figure_captions <- captioner::captioner(prefix="Figure")

t.ref <- function(label){
  stringr::str_extract(table_captions(label), "[^:]*")
}

f.ref <- function(label){
  stringr::str_extract(figure_captions(label), "[^:]*")
}

#values =c( "#BCE1EE","#416AAE", "#EA5839", "#8FC3DD", "#FDBE70", "#FEE597", "#FFFFBF", "#E5F5EE","#A50026", "#CE2726", "#649AC7", "#F88D51", "#313695") 
setwd("~/Documents/WorldBank")
Data_Extract_From_World_Development_Indicators_OCDE <- read_excel("Data_Extract_From_World_Development_Indicators-OCDE-BRCH-EU.xlsx", 
    sheet = "Data")
head(Data_Extract_From_World_Development_Indicators_OCDE)

Countries_continents <- read_excel("Countries_continents.xlsx", 
    sheet = "continents")
##Generando una funcion que limpie la fecha
# returns string w/o leading or trailing whitespace
#################
trim <- function (x) gsub("^\\s+|\\s+$", "", x)
#################


lower_case<-function(x){
  str_replace_all(tolower(x),"/",' ')
}


left = function (string,char){
  substr(string,1,char)
}

right = function (string, char){
  substr(string,nchar(string)-(char-1),nchar(string))
}

tab_stata_fun<-function(z,x,y){
  with(z, CrossTable(x, y, missing.include=TRUE))
}



tab_stata_one<-function(z,x){
  temporal<-z%>%group_by(.dots = lazyeval::lazy(x))%>%summarise(Observations=n())
  View(temporal)
}

md<-reshape2::melt(Data_Extract_From_World_Development_Indicators_OCDE%>%select(-`Series Code`), id.vars = c("Country Name", "Country Code","Series Name"))

md$Time<-ts(left(as.character(md$variable),4))
md$value<-as.double(md$value)
md<-md[,c(1,2,3,6,5)]
md<-left_join(md,Countries_continents)
md<-arrange(md,`Country Code`,`Series Name`,Time)%>%filter(!is.na(`Country Code`) | !is.na(`Series Name`))%>%arrange(desc(`Country Name`))
statis<-md%>%filter(!is.na(`Country Code`) | !is.na(`Series Name`))%>%dplyr::group_by(Continent,`Country Name`,`Series Name`)%>%dplyr::summarise(Mean=mean(value,na.rm = TRUE),SD=sd(value,na.rm = TRUE))

```

\newpage

# Summary

This document aims to consolidate available indicators as a *sandbox* tool for next analyses. For an easier navigation of the document, each indicator is fitted into the following categories:

+ Economy
+ Goverment
+ Health
+ Demographics

Altough some of them may overlapse with each other, for example poverty meassures, I do think this mechanism does allow for a better user experience of the document. Please refer to the table of contents whenever necessary.


For this document I focused on the OCDE Countries plus China and Brazil.

Database extracted from: https://databank.worldbank.org/data/source/world-development-indicators#

Country list from: https://www.oecd.org/about/members-and-partners/

After each indicator I have copied **World Bank's** metadata including:

+ Long Description
+ Source (when needed)
+ Statistical Concept & Methodology (when needed)
+ Limitations & Exceptions (when needed)

The extraction period is from 2000 to the last available date (in most cases 2017). Looking forward to an standarized presentation for each indicator first I present a table with the summary of average and standard deviation then followed by a box plot graph. When possible I also present graphs wiht the time series of the indicator for each of the countries. Finally, I aggregate the countries into region time series to see region's trends and compare them with the three biggest economies (United States, China and Japan).

\newpage

# Economy

## GDP (constant 2010 US$)


GDP at purchaser's prices is the sum of gross value added by all resident producers in the economy plus any product taxes and minus any subsidies not included in the value of the products. It is calculated without making deductions for depreciation of fabricated assets or for depletion and degradation of natural resources. Data are in constant 2010 U.S. dollars. Dollar figures for GDP are converted from domestic currencies using 2010 official exchange rates. For a few countries where the official exchange rate does not reflect the rate effectively applied to actual foreign exchange transactions, an alternative conversion factor is used.


Gross domestic product (GDP) represents the sum of value added by all its producers. Value added is the value of the gross output of producers less the value of intermediate goods and services consumed in production, before accounting for consumption of fixed capital in production. The United Nations System of National Accounts calls for value added to be valued at either basic prices (excluding net taxes on products) or producer prices (including net taxes on products paid by producers but excluding sales or value added taxes). Both valuations exclude transport charges that are invoiced separately by producers. Total GDP is measured at purchaser prices. Value added by industry is normally measured at basic prices. When value added is measured at producer prices.

Growth rates of GDP and its components are calculated using the least squares method and constant price data in the local currency. Constant price U.S. dollar series are used to calculate regional and income group growth rates. Local currency series are converted to constant U.S. dollars using an exchange rate in the common reference year.

Each industry's contribution to growth in the economy's output is measured by growth in the industry's value added. In principle, value added in constant prices can be estimated by measuring the quantity of goods and services produced in a period, valuing them at an agreed set of base year prices, and subtracting the cost of intermediate inputs, also in constant prices. This double-deflation method requires detailed information on the structure of prices of inputs and outputs.

In many industries, however, value added is extrapolated from the base year using single volume indexes of outputs or, less commonly, inputs. Particularly in the services industries, including most of government, value added in constant prices is often imputed from labor inputs, such as real wages or number of employees. In the absence of well defined measures of output, measuring the growth of services remains difficult.

Moreover, technical progress can lead to improvements in production processes and in the quality of goods and services that, if not properly accounted for, can distort measures of value added and thus of growth. When inputs are used to estimate output, as for nonmarket services, unmeasured technical progress leads to underestimates of the volume of output. Similarly, unmeasured improvements in quality lead to underestimates of the value of output and value added. The result can be underestimates of growth and productivity improvement and overestimates of inflation.

Informal economic activities pose a particular measurement problem, especially in developing countries, where much economic activity is unrecorded. A complete picture of the economy requires estimating household outputs produced for home use, sales in informal markets, barter exchanges, and illicit or deliberately unreported activities. The consistency and completeness of such estimates depend on the skill and methods of the compiling statisticians.

Rebasing of national accounts can alter the measured growth rate of an economy and lead to breaks in series that affect the consistency of data over time. When countries rebase their national accounts, they update the weights assigned to various components to better reflect current patterns of production or uses of output. The new base year should represent normal operation of the economy - it should be a year without major shocks or distortions. Some developing countries have not rebased their national accounts for many years. Using an old base year can be misleading because implicit price and volume weights become progressively less relevant and useful.

To obtain comparable series of constant price data for computing aggregates, the World Bank rescales GDP and value added by industrial origin to a common reference year. Because rescaling changes the implicit weights used in forming regional and income group aggregates, aggregate growth rates are not comparable with those from earlier editions with different base years. Rescaling may result in a discrepancy between the rescaled GDP and the sum of the rescaled components. To avoid distortions in the growth rates, the discrepancy is left unallocated. As a result, the weighted average of the growth rates of the components generally does not equal the GDP grow

 `r t.ref("gdp_table")` reports the averages for the current century.

```{r gdp, echo=FALSE, fig.cap=table_captions("gdp_table", "Summary of Indicators 2000 - 2017")}
knitr::kable(statis%>%filter(`Series Name`=="GDP (constant 2010 US$)") %>% mutate(Mean=prettyNum(Mean/1000000000,big.mark=",",scientific=FALSE,digits=1), SD = prettyNum(SD/1000000000,big.mark=",",scientific=FALSE,digits=1)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`),  align = c('l','r','r'),caption = "GDP (constant 2010 US$ '000 M)")

```

\newpage

In `r f.ref("GDP_graph")` it is possible to see the *GDP trend* from the current century. In the `r f.ref("GDP_graph_AGGR")` it is possible to see the trend for the biggest countries and regions of the world
	

```{r GDP_graph,warning=FALSE,results='hide',message=FALSE, fig.cap="GDP (constant 2010 US$)"}

ggplot(data=md%>%filter(`Series Name`=="GDP (constant 2010 US$)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(label = unit_format(unit = "K M", scale = 1e-9)) + labs(y="GDP",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), "")))) #,fig.keep='all'
```

```{r GDP_graph_AGGR,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP (constant 2010 US$) regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="GDP (constant 2010 US$)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(label = unit_format(unit = "B", scale = 1e-12,accuracy = 0.1)) + labs(y="GDP",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## GDP growth (annual %)

```{r gdpgrowthrate, fig.cap=table_captions("gdpgrowthrate", "")}
knitr::kable(statis%>%filter(`Series Name`=="GDP growth (annual %)")%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "GDP growth (annual %)")
#%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0))
```

```{r gdpgrowhtgraph, echo=FALSE,warning=FALSE, fig.cap="GDP growth rate boxplots: 2000 - 2017"}
md %>% filter(`Series Name`=="GDP growth (annual %)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="GDP growth (annual %)",x="Country Code") + theme_bw(base_size = 8)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="GDP growth (annual %)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

\newpage

## GDP per capita (constant 2010 US$)

```{r gdpxcapita, fig.cap=table_captions("gdpxcapita", "")}
knitr::kable(statis%>%filter(`Series Name`=="GDP per capita (constant 2010 US$)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0))%>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "GDP per capita (constant 2010 US$)")
```

```{r GDV_graphcapita,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP per capita"}

ggplot(data=md%>%filter(`Series Name`=="GDP per capita (constant 2010 US$)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="GDP per capita",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r GDV_graphcapita_AGRR,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP per capita regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="GDP per capita (constant 2010 US$)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::comma) + labs(y="GDP per capita (constant 2010 US$)",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## GDP per capita growth (annual %)

```{r gdpxcapitagrowth, fig.cap=table_captions("gdpxcapitagrowth", "")}
knitr::kable(statis%>%filter(`Series Name`=="GDP per capita growth (annual %)")%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "GDP per capita growth (annual %)")
```

```{r gdppercaptiagrowhtgraph, echo=FALSE,warning=FALSE, fig.cap="GDP per capita growth rate boxplots: 2000 - 2017"}
md %>% filter(`Series Name`=="GDP per capita growth (annual %)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="GDP per capita growth (annual %)",x="Country Code") + theme_bw(base_size = 8)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="GDP per capita growth (annual %)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

```{r warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP per capita growth rate"}

ggplot(data=md%>%filter(`Series Name`=="GDP per capita growth (annual %)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(label = unit_format(unit = "",scale = 1,accuracy = 0.1)) + labs(y="GDP per capita growth (annual %)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
# + ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP per capita growth rate regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="GDP per capita growth (annual %)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(label = unit_format(unit = "",scale = 1,accuracy = 0.1)) + labs(y="GDP per capita growth (annual %)",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
#labels = scales::number_format(accuracy = 0.01)
```

\newpage

## GDP per person employed (constant 2011 PPP $)

GDP per person employed is gross domestic product (GDP) divided by total employment in the economy. Purchasing power parity (PPP) GDP is GDP converted to 2011 constant international dollars using PPP rates. An international dollar has the same purchasing power over GDP that a U.S. dollar has in the United States.

GDP per person employed represents labor productivity — output per unit of labor input. To compare labor productivity levels across countries, GDP is converted to international dollars using purchasing power parity rates which take account of differences in relative prices between countries.

```{r gdpxemployee, fig.cap=table_captions("gdpxemployee", "")}
knitr::kable(statis%>%filter(`Series Name`=="GDP per person employed (constant 2011 PPP $)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0))%>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), caption = "GDP per person employed (constant 2011 PPP $)")
```


```{r GDV_graphcapitaemployeed,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP per person employed"}

ggplot(data=md%>%filter(`Series Name`=="GDP per person employed (constant 2011 PPP $)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="GDP per employee",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r GDV_graphemploy_AGRR,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP per person employed regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="GDP per person employed (constant 2011 PPP $)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::comma) + labs(y="GDP per employee",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```


\newpage

## GNI (constant 2010 US$)

GNI (formerly GNP) is the sum of value added by all resident producers plus any product taxes (less subsidies) not included in the valuation of output plus net receipts of primary income (compensation of employees and property income) from abroad. Data are in constant 2010 U.S. dollars.

Because development encompasses many factors - economic, environmental, cultural, educational, and institutional - no single measure gives a complete picture. However, the total earnings of the residents of an economy, measured by its gross national income (GNI), is a good measure of its capacity to provide for the well-being of its people.


```{r GNI_table, fig.cap=table_captions("GNI_table", "")}
knitr::kable(statis%>%filter(`Series Name`=="GNI (constant 2010 US$)" & !is.na(Mean)) %>% mutate(Mean=prettyNum(Mean/1000000000,big.mark=",",scientific=FALSE,digits=1), SD = prettyNum(SD/1000000000,big.mark=",",scientific=FALSE,digits=1))  %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`),align = c('l','r','r'), caption = "GNI (constant 2010 US$ '000 M)")
#
#prettyNum(GDP*IncomeShareTopTenpercent/1000000000,big.mark=",",scientific=FALSE,digits=1)
```
	

```{r warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GNI (constant 2010 US$)"}

ggplot(data=md%>%filter(`Series Name`=="GNI (constant 2010 US$)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(label = unit_format(unit = "K M", scale = 1e-9)) + labs(y="GNI (constant 2010 US$)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GNI (constant 2010 US$) regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="GNI (constant 2010 US$)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(label = unit_format(unit = "B", scale = 1e-12,accuracy = 0.1)) + labs(y="GNI (constant 2010 US$)",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
#labels = scales::number_format(accuracy = 0.01)
```

\newpage

## GNI growth (annual %)

```{r GNI_growth, fig.cap=table_captions("GNI_growth_table", "")}
knitr::kable(statis%>%filter(`Series Name`=="GNI growth (annual %)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "GDP growth (annual %)")
#%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0))
```

```{r  echo=FALSE,warning=FALSE, fig.cap="GNI growth boxplots: 2000 - 2017"}
md %>% filter(`Series Name`=="GNI growth (annual %)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="GNI growth (annual %)",x="Country Code") + theme_bw(base_size = 8)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="GNI growth (annual %)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

```{r warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GNI growth rate"}

ggplot(data=md%>%filter(`Series Name`=="GNI growth (annual %)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(label = unit_format(unit = "",scale = 1,accuracy = 0.1)) + labs(y="GNI growth (annual %)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
# + ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GNI growth rate regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="GNI growth (annual %)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(label = unit_format(unit = "",scale = 1,accuracy = 0.1)) + labs(y="GNI growth (annual %)",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
#labels = scales::number_format(accuracy = 0.01)
```

\newpage

## GNI per capita (constant 2010 US$)

## Income share held by subgroups of population

Percentage share of income or consumption is the share that accrues to subgroups of population indicated by deciles or quintiles.

Inequality in the distribution of income is reflected in the share of income or consumption accruing to a portion of the population ranked by income or consumption levels. The portions ranked lowest by personal income receive the smallest shares of total income.

Data on the distribution of income or consumption come from nationally representative household surveys. Where the original data from the household survey were available, they have been used to directly calculate the income or consumption shares by quintile. Otherwise, shares have been estimated from the best available grouped data.

The distribution data have been adjusted for household size, providing a more consistent measure of per capita income or consumption. No adjustment has been made for spatial differences in cost of living within countries, because the data needed for such calculations are generally unavailable. For further details on the estimation method for low- and middle-income economies, see Ravallion and Chen (1996).

Despite progress in the last decade, the challenges of measuring poverty remain. The timeliness, frequency, quality, and comparability of household surveys need to increase substantially, particularly in the poorest countries. The availability and quality of poverty monitoring data remains low in small states, countries with fragile situations, and low-income countries and even some middle-income countries. The low frequency and lack of comparability of the data available in some countries create uncertainty over the magnitude of poverty reduction. 

Besides the frequency and timeliness of survey data, other data quality issues arise in measuring household living standards. The surveys ask detailed questions on sources of income and how it was spent, which must be carefully recorded by trained personnel. Income is generally more difficult to measure accurately, and consumption comes closer to the notion of living standards. And income can vary over time even if living standards do not. But consumption data are not always available: the latest estimates reported here use consumption data for about two-thirds of countries.

However, even similar surveys may not be strictly comparable because of differences in timing or in the quality and training of enumerators. Comparisons of countries at different levels of development also pose a potential problem because of differences in the relative importance of the consumption of nonmarket goods. The local market value of all consumption in kind (including own production, particularly important in underdeveloped rural economies) should be included in total consumption expenditure but may not be. Most survey data now include valuations for consumption or income from own production, but valuation methods vary.

Survey year is the year in which the underlying household survey data were collected or, when the data collection period bridged two calendar years, the year in which most of the data were collected.

Percentage shares by quintile may not sum to 100 because of rounding.

\newpage

### Income share held by lowest 10%



```{r Income_10_l, fig.cap=table_captions("Income_10_l_table", "")}

knitr::kable(statis%>%filter(`Series Name`=="Income share held by lowest 10%"& !is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Income share held by lowest 10%")
```


```{r warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Income share held by lowest 10%"}

ggplot(data=md%>%filter(`Series Name`=="Income share held by lowest 10%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Income share held by lowest 10%",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```

```{r  echo=FALSE,warning=FALSE, fig.cap="Income share held by lowest 10% boxplots: 2000 - 2017"}
md %>% filter(`Series Name`=="Income share held by lowest 10%" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Income share held by lowest 10%",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Income share held by lowest 10%")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

### Income share held by lowest 20%

```{r Income_20_l, fig.cap=table_captions("Income_20_l_table", "")}

knitr::kable(statis%>%filter(`Series Name`=="Income share held by lowest 20%" & !is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Income share held by lowest 20%")
```

```{r warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Income share held by lowest 20%"}

ggplot(data=md%>%filter(`Series Name`=="Income share held by lowest 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Income share held by lowest 20%",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```

```{r , echo=FALSE,warning=FALSE, fig.cap="Income share held by lowest 20% boxplots: 2000 - 2017"}
md %>% filter(`Series Name`=="Income share held by lowest 20%" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Income share held by lowest 20%",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Income share held by bottom 20%")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

### Income share held by second 20%

```{r Income_20_2, fig.cap=table_captions("Income_20_2_table", "")}

knitr::kable(statis%>%filter(`Series Name`=="Income share held by second 20%" & !is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Income share held by second 20%")
```

```{r, warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Income share held by second 20%"}

ggplot(data=md%>%filter(`Series Name`=="Income share held by second 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Income share held by second 20%",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```

```{r , echo=FALSE,warning=FALSE, fig.cap="Income share held by second 20% boxplots: 2000 - 2017"}
md %>% filter(`Series Name`=="Income share held by second 20%" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Income share held by lowest 20%",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Income share held by bottom 20%")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

### Income share held by third 20%

```{r Income_20_3, fig.cap=table_captions("Income_20_3_table", "")}

knitr::kable(statis%>%filter(`Series Name`=="Income share held by third 20%" & !is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Income share held by third 20%")
```

```{r, warning=FALSE,results='hide',message=FALSE,fig.keep='all'}

ggplot(data=md%>%filter(`Series Name`=="Income share held by third 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Income share held by third 20%",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```

```{r thirdtwentypercentgraph_2, echo=FALSE,warning=FALSE}
md %>% filter(`Series Name`=="Income share held by third 20%" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Income share held by third 20%",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Income share held by third 20%")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

### Income share held by fourth 20%

```{r Income_20_4, fig.cap=table_captions("Income_20_4_table", "")}

knitr::kable(statis%>%filter(`Series Name`=="Income share held by fourth 20%" & !is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Income share held by fourth 20%")
```

```{r, warning=FALSE,results='hide',message=FALSE,fig.keep='all'}

ggplot(data=md%>%filter(`Series Name`=="Income share held by fourth 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Income share held by fourth 20%",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```


```{r fourthtwentypercentgraph_2, echo=FALSE,warning=FALSE}
md %>% filter(`Series Name`=="Income share held by fourth 20%" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Income share held by fourth 20%",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Income share held by fourth 20%")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

### Income share held by highest 20%

```{r Income_20_h, fig.cap=table_captions("Income_20_h_table", "")}

knitr::kable(statis%>%filter(`Series Name`=="Income share held by highest 20%" & !is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Income share held by highest 20%")
```

```{r, warning=FALSE,results='hide',message=FALSE,fig.keep='all'}

ggplot(data=md%>%filter(`Series Name`=="Income share held by highest 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Income share held by highest 20%",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```

```{r toptwentypercentgraph_2, echo=FALSE,warning=FALSE}
md %>% filter(`Series Name`=="Income share held by highest 20%" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Income share held by highest 20%",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Income share held by highest 20%")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

### Income share held by highest 10%

```{r Income_10_h, fig.cap=table_captions("Income_10_h_table", "")}

knitr::kable(statis%>%filter(`Series Name`=="Income share held by highest 10%"& !is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Income share held by highest 10%")
```

```{r, toptenpercentgraph_1,warning=FALSE,results='hide',message=FALSE,fig.keep='all'}

ggplot(data=md%>%filter(`Series Name`=="Income share held by highest 10%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Income share held by highest 10%",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```

```{r bottomtenpercentgraph_1, echo=FALSE,warning=FALSE}
md %>% filter(`Series Name`=="Income share held by highest 10%" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Income share held by highest 10%",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Income share held by highest 10%")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

## GDP & GNI per Capita estimations

Based on the **mean income share** from the period in this section I present the estimates for the **GDP per Capita** and the **GNI per Capita** for each of the **subgroups of population**.


### Mean Income Share

```{r }
first20s<-md %>% filter(`Series Name`=="Income share held by highest 20%" & !is.na(md$value))%>%group_by(`Country Name`, `Country Code`,Continent) %>%dplyr::summarise(Mean=percent(mean(value,na.rm = TRUE)/100),SD=percent(ifelse(!is.na(sd(value,na.rm = TRUE)),sd(value,na.rm = TRUE)/100,0)))%>%mutate(Indicator=1,Share="Top 20%")
second20s<-md %>% filter(`Series Name`=="Income share held by second 20%" & !is.na(md$value))%>%group_by(`Country Name`, `Country Code`,Continent) %>%dplyr::summarise(Mean=percent(mean(value,na.rm = TRUE)/100),SD=percent(ifelse(!is.na(sd(value,na.rm = TRUE)),sd(value,na.rm = TRUE)/100,0)))%>%mutate(Indicator=4,Share="Second 20%")
third20s <-md %>% filter(`Series Name`=="Income share held by third 20%" & !is.na(md$value))%>%group_by(`Country Name`, `Country Code`,Continent) %>%dplyr::summarise(Mean=percent(mean(value,na.rm = TRUE)/100),SD=percent(ifelse(!is.na(sd(value,na.rm = TRUE)),sd(value,na.rm = TRUE)/100,0)))%>%mutate(Indicator=3,Share="Third 20%")
forth20s<-md %>% filter(`Series Name`=="Income share held by fourth 20%" & !is.na(md$value))%>%group_by(`Country Name`, `Country Code`,Continent) %>%dplyr::summarise(Mean=percent(mean(value,na.rm = TRUE)/100),SD=percent(ifelse(!is.na(sd(value,na.rm = TRUE)),sd(value,na.rm = TRUE)/100,0)))%>%mutate(Indicator=2,Share="Forth 20%")
fifth20s<-md %>% filter(`Series Name`=="Income share held by lowest 20%" & !is.na(md$value))%>%group_by(`Country Name`, `Country Code`,Continent) %>%dplyr::summarise(Mean=percent(mean(value,na.rm = TRUE)/100),SD=percent(ifelse(!is.na(sd(value,na.rm = TRUE)),sd(value,na.rm = TRUE)/100,0)))%>%mutate(Indicator=5,Share="Bottom 20%")
cumulative_share<-rbind(first20s,second20s,third20s,forth20s,fifth20s)%>%arrange(`Country Name`,Indicator)
#as.numeric(sub("%", "", percent_vec))+ theme_bw(base_size = 5)+scale_y_continuous(limits = c(0, 100))
cumulative_share$Mean<-as.numeric(sub("%", "", cumulative_share$Mean))
cumulative_share$Share<-factor(cumulative_share$Share,levels = c("Bottom 20%","Second 20%","Third 20%","Forth 20%","Top 20%"))
#factor(cumulative_share$Share,levels = c("Top 20%","Second 20%","Third 20%","Forth 20%","Bottom 20%"))
#factor(MTR_PS_RD_Trxs$PROGRAM_NAM,levels=c("Scotia Rewards Classic","Scotia Travel Classic","Viva Recompensas","Scotia Travel Gold","Scotia Travel Platinum","Scotia Travel Black"))
cumulative_share$cumulative_contry<-as.numeric(unlist(tapply(cumulative_share$Mean, cumulative_share$`Country Name`, cumsum)))
p <- ggplot(data = cumulative_share, aes(x = `Country Code`, y = Mean)) +
  geom_col(aes(fill = Share))+ labs(y="Mean Income Share %",x="Country Code")+ theme_bw(base_size = 8)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))
p +  geom_text(aes(y = cumulative_contry, label =Mean, group =Share), color = "black",size=1.5)+ scale_fill_manual(values = c("#d95f0e","#2ca25f","#99d8c9", "#9ecae1","#3182bd"))
```

\newpage

### Lowest 10% 




```{r Income_shr_10_l, fig.cap=table_captions("Income_shr_10_l", "")}
#paste(format(round(x / 1e6, 1), trim = TRUE), "M")
auxiliar1<-statis%>%filter(`Series Name`=="Income share held by lowest 10%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")& !is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,IncomeShareTopTenpercent=Mean/100)
auxiliar2<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GDP=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
auxiliar4<-statis%>%filter(`Series Name`=="GNI (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GNI=Mean)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean) #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M")
auxiliar5<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name") %>% inner_join(auxiliar4,by="Country Name") %>%mutate(`GDP x Capita`=prettyNum(GDP*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GNI x Capita`=prettyNum(GNI*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GDP Share '000 M`=prettyNum(GDP*IncomeShareTopTenpercent/1000000000,big.mark=",",scientific=FALSE,digits=1),`Income share held`=percent(IncomeShareTopTenpercent),`Pop (#)`=prettyNum(Population*.1,big.mark=",",scientific=FALSE,digits=0))%>%select(-Population,-GDP,-GNI,-IncomeShareTopTenpercent,-`GDP Share '000 M`)
knitr::kable(auxiliar5, caption = "Per Capita estimations (Lowest 10%)",align = c('l','r','r','c','r'))
```

`r t.ref("Income_shr_10_l")` allows to see that the impact of Gross National Income is bigger than the percentage of income share held by population. For example, zooming `r t.ref("Income_shr_10_l")` it is possible to see that there is a clear difference between income share held by lowest 10th percent of population in America and Europe. In Europe all of the countries presented an average for the current century bigger than 3\% rather in America all of them presented an average lesser than 2\%. More precisely for Mexico's case it is possible to see that the income share held by lowest 10th percent of population is slighly higher (as a percentage) than the one of the United States. However, given their GNI difference in reallity a USA citizen lifes with an average of $5.14=(4,275/831)$ times more annual income than a Mexican citizen (eventhough as a percentage of their respectively GNI Mexico's income share held by lowest 10th percent is 10 percentual points higher than the one of the United States!).    

\newpage

### Lowest 20% (1st quintile)


```{r Income_shr_20_l, fig.cap=table_captions("Income_shr_20_l", "")}
#paste(format(round(x / 1e6, 1), trim = TRUE), "M")
auxiliar1<-statis%>%filter(`Series Name`=="Income share held by lowest 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,IncomeShareTopTenpercent=Mean/100)
auxiliar2<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GDP=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
auxiliar4<-statis%>%filter(`Series Name`=="GNI (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GNI=Mean)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean) #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M")
auxiliar5<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name") %>% inner_join(auxiliar4,by="Country Name") %>%mutate(`GDP x Capita`=prettyNum(GDP*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GNI x Capita`=prettyNum(GNI*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GDP Share '000 M`=prettyNum(GDP*IncomeShareTopTenpercent/1000000000,big.mark=",",scientific=FALSE,digits=1),`Income share held`=percent(IncomeShareTopTenpercent),`Pop (#)`=prettyNum(Population*.2,big.mark=",",scientific=FALSE,digits=0))%>%select(-Population,-GDP,-GNI,-IncomeShareTopTenpercent,-`GDP Share '000 M`)
knitr::kable(auxiliar5, caption = "Per Capita estimations (Lowest 20%)",align = c('l','r','r','c','r'))
```

\newpage

### Second 20% (2nd quintile)


```{r Income_shr_20_2, fig.cap=table_captions("Income_shr_20_2", "")}
#paste(format(round(x / 1e6, 1), trim = TRUE), "M")
auxiliar1<-statis%>%filter(`Series Name`=="Income share held by second 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,IncomeShareTopTenpercent=Mean/100)
auxiliar2<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GDP=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
auxiliar4<-statis%>%filter(`Series Name`=="GNI (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GNI=Mean)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean) #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M")
auxiliar5<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name") %>% inner_join(auxiliar4,by="Country Name") %>%mutate(`GDP x Capita`=prettyNum(GDP*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GNI x Capita`=prettyNum(GNI*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GDP Share '000 M`=prettyNum(GDP*IncomeShareTopTenpercent/1000000000,big.mark=",",scientific=FALSE,digits=1),`Income share held`=percent(IncomeShareTopTenpercent),`Pop (#)`=prettyNum(Population*.2,big.mark=",",scientific=FALSE,digits=0))%>%select(-Population,-GDP,-GNI,-IncomeShareTopTenpercent,-`GDP Share '000 M`)
knitr::kable(auxiliar5, caption = "Per Capita estimations (Second 20%)",align = c('l','r','r','c','r'))
```

\newpage

### Third 20% (3rd quintile)

```{r Income_shr_20_3, fig.cap=table_captions("Income_shr_20_3", "")}
#paste(format(round(x / 1e6, 1), trim = TRUE), "M")
auxiliar1<-statis%>%filter(`Series Name`=="Income share held by third 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,IncomeShareTopTenpercent=Mean/100)
auxiliar2<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GDP=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
auxiliar4<-statis%>%filter(`Series Name`=="GNI (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GNI=Mean)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean) #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M")
auxiliar5<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name") %>% inner_join(auxiliar4,by="Country Name") %>%mutate(`GDP x Capita`=prettyNum(GDP*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GNI x Capita`=prettyNum(GNI*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GDP Share '000 M`=prettyNum(GDP*IncomeShareTopTenpercent/1000000000,big.mark=",",scientific=FALSE,digits=1),`Income share held`=percent(IncomeShareTopTenpercent),`Pop (#)`=prettyNum(Population*.2,big.mark=",",scientific=FALSE,digits=0))%>%select(-Population,-GDP,-GNI,-IncomeShareTopTenpercent,-`GDP Share '000 M`)
knitr::kable(auxiliar5, caption = "Per Capita estimations (Third 20%)",align = c('l','r','r','c','r'))
```

\newpage

### Fourth 20% (4th quintile)

```{r Income_shr_20_4, fig.cap=table_captions("Income_shr_20_4", "")}
#paste(format(round(x / 1e6, 1), trim = TRUE), "M")
auxiliar1<-statis%>%filter(`Series Name`=="Income share held by fourth 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,IncomeShareTopTenpercent=Mean/100)
auxiliar2<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GDP=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
auxiliar4<-statis%>%filter(`Series Name`=="GNI (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GNI=Mean)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean) #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M")
auxiliar5<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name") %>% inner_join(auxiliar4,by="Country Name") %>%mutate(`GDP x Capita`=prettyNum(GDP*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GNI x Capita`=prettyNum(GNI*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GDP Share '000 M`=prettyNum(GDP*IncomeShareTopTenpercent/1000000000,big.mark=",",scientific=FALSE,digits=1),`Income share held`=percent(IncomeShareTopTenpercent),`Pop (#)`=prettyNum(Population*.2,big.mark=",",scientific=FALSE,digits=0))%>%select(-Population,-GDP,-GNI,-IncomeShareTopTenpercent,-`GDP Share '000 M`)
knitr::kable(auxiliar5, caption = "Per Capita estimations (Fourth 20%)",align = c('l','r','r','c','r'))
```

\newpage

### Highest 20% (5th quintile)

```{r Income_shr_20_h, fig.cap=table_captions("Income_shr_20_h", "")}
#paste(format(round(x / 1e6, 1), trim = TRUE), "M")
auxiliar1<-statis%>%filter(`Series Name`=="Income share held by highest 20%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,IncomeShareTopTenpercent=Mean/100)
auxiliar2<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GDP=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
auxiliar4<-statis%>%filter(`Series Name`=="GNI (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GNI=Mean)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean) #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M")
auxiliar5<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name") %>% inner_join(auxiliar4,by="Country Name") %>%mutate(`GDP x Capita`=prettyNum(GDP*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GNI x Capita`=prettyNum(GNI*IncomeShareTopTenpercent/(Population*.2),big.mark=",",scientific=FALSE,digits=0),`GDP Share '000 M`=prettyNum(GDP*IncomeShareTopTenpercent/1000000000,big.mark=",",scientific=FALSE,digits=1),`Income share held`=percent(IncomeShareTopTenpercent),`Pop (#)`=prettyNum(Population*.2,big.mark=",",scientific=FALSE,digits=0))%>%select(-Population,-GDP,-GNI,-IncomeShareTopTenpercent,-`GDP Share '000 M`)
knitr::kable(auxiliar5, caption = "Per Capita estimations (Fifth 20%)",align = c('l','r','r','c','r'))
```


\newpage

### Highest 10% 


```{r Income_shr_10_h, fig.cap=table_captions("Income_shr_10_h", "")}
#paste(format(round(x / 1e6, 1), trim = TRUE), "M")
auxiliar1<-statis%>%filter(`Series Name`=="Income share held by highest 10%" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,IncomeShareTopTenpercent=Mean/100)
auxiliar2<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GDP=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
auxiliar4<-statis%>%filter(`Series Name`=="GNI (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GNI=Mean)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean) #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M")
auxiliar5<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name") %>% inner_join(auxiliar4,by="Country Name") %>%mutate(`GDP x Capita`=prettyNum(GDP*IncomeShareTopTenpercent/(Population*.1),big.mark=",",scientific=FALSE,digits=0),`GNI x Capita`=prettyNum(GNI*IncomeShareTopTenpercent/(Population*.1),big.mark=",",scientific=FALSE,digits=0),`GDP Share '000 M`=prettyNum(GDP*IncomeShareTopTenpercent/1000000000,big.mark=",",scientific=FALSE,digits=1),`Income share held`=percent(IncomeShareTopTenpercent),`Pop (#)`=prettyNum(Population*.1,big.mark=",",scientific=FALSE,digits=0))%>%select(-Population,-GDP,-GNI,-IncomeShareTopTenpercent,-`GDP Share '000 M`)
knitr::kable(auxiliar5, caption = "Per Capita estimations (Highest 10%)",align = c('l','r','r','c','r'))
```


\newpage

## GDP and Population

In this section I simulate scenarios based on the **GDP annual growth rate**, current **GDP** level, **Population** and **Population growth**. The main idea on this part of the text is to see how much time would it take for less develop countries at the *current rates* to get to a level of the develpoment - meassure by the **GDP per capita** - similar to the more develop ones. From that based scenario I will perform simulations based on different GDP **GDP annual growth rate**s and see how the dinamycs behaive.

First let's have a summary of what we just saw in the prior sections. In `r t.ref("gpd_pop_1")` I report the averages for the current century.

```{r tab_sims_1, fig.cap="\\label{fig:tab_sims_1}"}
#paste(format(round(x / 1e6, 1), trim = TRUE), "M")
auxiliar1<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,GDP=Mean)
auxiliar2<-statis%>%filter(`Series Name`=="GDP per capita (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,`GDP per capita`=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
#GNI per capita (constant 2010 US$)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean) #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M") %>% inner_join(auxiliar4,by="Country Name") 
auxiliar4<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name")%>%mutate(`GDP per capita`=prettyNum(`GDP per capita`,big.mark=",",scientific=FALSE,digits=0),`GDP '000 M`=prettyNum(GDP/1000000000,big.mark=",",scientific=FALSE,digits=1),`Pop (#)`=prettyNum(Population,big.mark=",",scientific=FALSE,digits=0))%>%select(-Population,-GDP)
#knitr::kable(auxiliar4, caption = "Summary of Indicators 2000 - 2016",align = c('l','r','r','r','r'))
```

```{r chunk_creating_one_table, echo=FALSE, fig.cap=table_captions("gpd_pop_1", "")}
knitr::kable(auxiliar4, caption = "Summary of Indicators 2000 - 2017",align = c('l','r','r','r','c'))

```

Theoretically there exists two sides of the inequality issue, eventhough they are not disassociated they can be exposed as: 

+ **Redistribute** more the current resources.
+ **Grow the economy** at the current inequallity ratios.

For example, as a simplistic approach lets make the following exercise. What would happen if at the current **inequallity ratios** Mexico, my country, had the **GDP per captia** of his northern neighbour, United States. 

What will need to be Mexico's **Gross Domestic Product**?



```{r firstapproach, fig.cap=table_captions("firstapproach", "")}
country="Mexico"
#For simmulations
country_aim<-"United States"

last_year_available<-md%>%filter(`Series Name`=="GDP (constant 2010 US$)"& `Country Name`==country & !is.na(value))%>%select(Time)%>%tail( n=1)%>%as.double()

population<-md%>%filter(`Series Name`=="Population, total"& `Country Name`==country & !is.na(value))%>%select(value)%>%tail( n=1)%>%as.double()
population_char<-prettyNum(population/1000000,big.mark=",",scientific=FALSE,digits=2)
gdp<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)" & `Country Name`==country)%>%group_by()%>%summarise(Population=Mean)%>%as.double()

gdp_char<-prettyNum(gdp/1000000000000,big.mark=",",scientific=FALSE,digits=2)

auxiliar1<-statis%>%filter(`Series Name`=="GDP (constant 2010 US$)" & (`Country Name` !=country &`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia")&!is.na(Mean)) %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Continent = Continent,GDP=Mean)
auxiliar2<-statis%>%filter(`Series Name`=="GDP per capita (constant 2010 US$)") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,`GDP per capita`=Mean)
auxiliar3<-statis%>%filter(`Series Name`=="Population, total") %>% ungroup()%>%transmute(`Country Name`=`Country Name`,Population=Mean)
#GNI per capita (constant 2010 US$)
#%>%transmute(`Country Name`=`Country Name`,Population=Mean)  #%>%mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`)
#paste(format(round(GDP*IncomeShareTopTenpercent / 1e9, 1), trim = TRUE), "'000 M") paste(format(round(GDP / 1e9, 1), trim = TRUE), "'000 M") %>% inner_join(auxiliar4,by="Country Name") 
auxiliar4<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name")%>%mutate(`GDP Actual '000 M`=prettyNum(gdp/1000000000,big.mark=",",scientific=FALSE,digits=1),`GDP Estimated '000 M`=prettyNum(population*`GDP per capita`/1000000000,big.mark=",",scientific=FALSE,digits=1),`GDP per capita (aim)`=prettyNum(`GDP per capita`,big.mark=",",scientific=FALSE,digits=0),`Ratio Est/Act`=prettyNum((population*`GDP per capita`)/gdp,big.mark=",",scientific=FALSE,digits=2))%>%select(-Population,-GDP,-`GDP per capita`)

captions=paste0("GDP Estimations for ",country,". GDP Actual: ",gdp_char," BN USD (2011), Population: ",population_char," at ",last_year_available)
knitr::kable(auxiliar4%>%select(-Continent,-`GDP Actual '000 M`), caption = captions,align = c('l','r','r','r','c'))

```

`r t.ref("firstapproach")` shows the **GDP estimations** that results from the multiplication of the **GDP per capita** of the different countries times the **current population** of the country. In fourth column it's possible to see the number of times the current **GDP** must change to accomplish that level.


\newpage

How much time does it is expected to lapse before it happen?

To address this question I first construct non-stochastics models that captures the averages of the period. In a second part I propose a stochastic model for the growth rates. Where instead of a constant growth rate in each iteration I propose the realization of a normal distribution function with the mean and standard deviation of the period for each variable.

Both sections are based on a *first order autonomos and homogenous differential equation system*. Before starting simulations let's review the maths involved in it.

$$\textbf{[GDP growth]} \Rightarrow \dot{GDP}=\alpha \times GDP$$
$$\textit{where }\alpha=\sum_{t=T_{0}}^{T_{f}}\frac{GDPgrowth_{t}}{T},T=T_{f}-T_{0}$$

and 

$$\textbf{[Population growth]} \Rightarrow \dot{Pop}=\beta \times Pop$$

$$\textit{where }\beta=\sum_{t=T_{0}}^{T_{f}}\frac{Popgrowth_{t}}{T},T=T_{f}-T_{0}$$

Both Population and GDP growth can be easily calculated in the following manner:

$$\dot{GDP}=\alpha GDP \leftrightarrow \frac{\dot{GDP}}{GDP}=\alpha \leftrightarrow \int\frac{\dot{GDP}}{GDP}dt=\int\alpha dt \leftrightarrow \ln GDP=\alpha t+k \leftrightarrow GDP=Ke^{\alpha t}$$
finally as we know the last value of the series  $\textit{(t=0)} \equiv t=20017$ we can find the value for $K$

$$GDP(0)=GDP_{2017}\rightarrow K e^{\alpha 0}=K=GDP_{2017}$$
$$\Rightarrow GDP(t)=GDP_{2017} e^{\alpha t}, \textit{ }t \in[1,17] \tag{1}$$

Similarly for population

$$\dot{Pop}=\beta Pop \leftrightarrow \frac{\dot{Pop}}{Pop}=\beta \leftrightarrow \int\frac{\dot{Pop}}{Pop}dt=\int\beta dt \leftrightarrow \ln Pop=\beta t+k \leftrightarrow Pop=Ke^{\beta t}$$

as we also know the last value of the series  $\textit{(t=0)} \equiv t=20017$ we can find the value for $K$

$$Pop(0)=Pop_{2017}\rightarrow K e^{\beta 0}=K=Pop_{2017}$$

$$\Rightarrow Pop(t)=Pop_{2017} e^{\beta t}, \textit{ }t \in[1,17] \tag{2}$$

Equations $(1)$ and $(2)$ describe the dynamics that GDP and Population will follow in the simulations. During the **non-stochastic** implementation of the models the variables follow a **constant growth rate**. In the stochastic section the growth rates $\alpha$ and $\beta$ are modeled by normal distributions using period's mean and standard deviation for each of the two variables.



### Non-stochastic models

```{r Definitions}


auxiliar5<-inner_join(auxiliar1,auxiliar2,by = "Country Name") %>% inner_join(auxiliar3,by="Country Name")%>%mutate(`GDP Actual`=gdp,`GDP Estimated`=population*`GDP per capita`,`GDP per capita (aim)`=`GDP per capita`,`Ratio Est/Act`=(population*`GDP per capita`)/gdp)%>%select(-Population,-GDP,-`GDP per capita`)

populationgrowth<-md%>%filter(`Series Name`=="Population, total") %>% group_by(`Country Name`) %>% mutate(populationgrowth = (value - lag(value))/lag(value))%>%filter(`Country Name`==country)%>%group_by()%>%summarise(populationgrowth=mean(populationgrowth,na.rm = TRUE))%>%as.double()

populationgrowth_variance<-md%>%filter(`Series Name`=="Population, total") %>% group_by(`Country Name`) %>% mutate(populationgrowth = (value - lag(value))/lag(value))%>%filter(`Country Name`==country)%>%group_by()%>%summarise(populationgrowth=sd(populationgrowth,na.rm = TRUE))%>%as.double()

GDPgrowth<-md%>%filter(`Series Name`=="GDP growth (annual %)"& `Country Name`==country) %>% group_by(`Country Name`)%>%group_by()%>%summarise(GDPgrowthmean=mean(value,na.rm = TRUE))%>%as.double()

GDPvariance<-md%>%filter(`Series Name`=="GDP growth (annual %)"& `Country Name`==country) %>% group_by(`Country Name`)%>%group_by()%>%summarise(GDPgrowthmean=sd(value,na.rm = TRUE))%>%as.double()

gdp_x_capita_actual<-md%>%filter(`Series Name`=="GDP per capita (constant 2010 US$)"& `Country Name`==country & !is.na(value))%>%select(value)%>%tail( n=1)%>%as.double()

gdp_capita_aim<-auxiliar5%>%filter(`Country Name`==country_aim)%>%select(`GDP per capita (aim)`)%>%as.double()

population_actual<-md%>%filter(`Series Name`=="Population, total"& `Country Name`==country & !is.na(value))%>%select(value)%>%tail( n=1)%>%as.double()

gdp_actual<-md%>%filter(`Series Name`=="GDP (constant 2010 US$)"& `Country Name`==country & !is.na(value))%>%select(value)%>%tail( n=1)%>%as.double()



gdp_aim_fix<-auxiliar5%>%filter(`Country Name`==country_aim)%>%select(`GDP per capita (aim)`)%>%transmute(`GDP (aim)`=population_actual*`GDP per capita (aim)`)%>%as.double()

```



#### Static Population Model

```{r SimpliestModel_EstablePopulation}
years=(log10(gdp_aim_fix)-log10(gdp_actual))/log10(1+GDPgrowth/100)
LVmod <- function(Time, State, Pars) {
  with(as.list(c(State, Pars)), {

    GrowthPop   <-  rGrow_Pop 
    incomegrw <- Grow_GDP_mean* GDP_Estimations #* (1 - GDP_Estimations/GDP_Aim_Fix) rnorm(1,Grow_GDP_mean,Grow_GDP_variance) 
    
    Population_Estimations  <- GrowthPop 
    GDP_Estimations <- incomegrw
    #cost    <- (income) * assEff + pricehospbed*beds + priceroadkm*roads
    
    return(list(c(Population_Estimations, GDP_Estimations)))
  })
}

pars  <- c(rGrow_Pop  = 0.0,    # /day, growth rate of population 
           Grow_GDP_mean  = GDPgrowth/100,
           Grow_GDP_variance = GDPvariance/100,
           GDP_Aim_Fix = gdp_aim_fix)

yini  <- c(Population = population_actual, GDP_Estimations = gdp_actual)
times <- seq(2018, 2018 + as.integer(years)+1, by = 1)
out   <- ode(yini, times, LVmod, pars)
```


#### Results of static population model

```{r, echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all'}
results<-as.data.frame(out,row.names = FALSE)
#ByProgram2$Balance_Promedio<-prettyNum(ByProgram2$Balance_Promedio,big.mark = ",",scientific=FALSE,digits=0)
#p<-ggplot(data=results,mapping=aes(x=time,y=Population))+geom_line(colour="dodgerblue4") 

p<-ggplot(data=results,mapping=aes(x=time,y=Population))+geom_smooth(colour="dodgerblue4",size = .5)+geom_point(colour="dodgerblue4",size = .5)

p<-p+scale_colour_manual(values =c("dodgerblue4"))+scale_y_continuous(label = unit_format(unit = "MM", scale = 1e-6)) + labs(y="Population",x="Time (iteration)") + theme_bw(base_size = 8)
#+ylim(low=1500000000000, high=2500000000000)


#c<-ggplot(data=results,mapping=aes(x=time,y=GDP_Estimations))+geom_line(colour="#EA5839") 
c<-ggplot(data=results,mapping=aes(x=time,y=GDP_Estimations))+geom_smooth(colour="#EA5839",size = .5)+geom_point(colour="#EA5839",size = .5)

c<-c+scale_colour_manual(values =c("#EA5839")) +scale_y_continuous(label = unit_format(unit = "BN", scale = 1e-12,accuracy = .1))  + labs(y="GDP (2010 US$)",x="Time (iteration)") + theme_bw(base_size = 8)

#i<-ggplot(data=results%>%mutate(GDP_x_Capita=GDP_Estimations/Population),mapping=aes(x=time,y=GDP_x_Capita))+geom_line(colour="#313695") 
i<-ggplot(data=results%>%mutate(GDP_x_Capita=GDP_Estimations/Population),mapping=aes(x=time,y=GDP_x_Capita))+geom_smooth(colour="#313695",size = .5)+geom_point(colour="#313695",size = .5)

i<-i+scale_colour_manual(values =c("#313695")) +scale_y_continuous(label = unit_format(unit = "K", scale = 1e-3,accuracy = .1))  + labs(y="GDP per Capita Est",x="Time (iteration)") + theme_bw(base_size = 8)


grid.arrange(c,p,i,ncol=1,top = textGrob("Results: static population model",gp=gpar(fontsize=10,font=3)))

```

The results of this model captures the **average GDP growth rate** of this century. It is based on a static population ($\textbf{population growth rate}=0$). Under this circumstances the followings yiels:

```{r staticmodel, fig.cap=table_captions("staticmodel", "")}
results<-results%>%mutate(GDP_x_Capita=GDP_Estimations/Population)
#labels<-c('\u03B1','\u03B2','Start year','Years (#)','Start GDP','Aim GDP','Last GDP x cap','Last Pop')
#labels<-c('Alpha','Beta','Start year','Years (#)','Start GDP','Aim GDP','Last GDP x cap','Last Pop')
labels<-c('CAGR (GDP)','CAGR (Pop)','Start year','Years (#)','Start GDP','Aim GDP','Last GDP x cap','Last Pop')
pop_last<-results%>%filter(GDP_x_Capita<=gdp_capita_aim)%>%select(Population)%>%tail( n=1)%>%as.double()
Assumptions<-c(round(GDPgrowth/100,digits = 3),round(populationgrowth-populationgrowth,3),round(last_year_available),years,gdp_actual,gdp_aim_fix,gdp_capita_aim,pop_last)
tableresults<-data.frame(Assumptions)
tableresults<-transpose(tableresults)%>%data.frame()
colnames(tableresults)<-labels
tableresults$`GDP BN (A)`<-prettyNum(tableresults$`Start GDP`/1000000000000,big.mark=",",scientific=FALSE,digits=3)
tableresults$`GDP BN`<-prettyNum(tableresults$`Aim GDP`/1000000000000,big.mark=",",scientific=FALSE,digits=3)
tableresults$`GDP x Cap` <-prettyNum(tableresults$`Last GDP x cap`,big.mark=",",scientific=FALSE,digits=0)
tableresults$`GDP x Cap Grw` <-percent((tableresults$`Last GDP x cap`/gdp_x_capita_actual)-1)
tableresults$`Start year`<-as.integer(tableresults$`Start year`)
tableresults$`Years (#)`<-as.integer(tableresults$`Years (#)`)
tableresults$`Pop MM` <-prettyNum(tableresults$`Last Pop`/1000000,big.mark=",",scientific=FALSE,digits=0)
tableresults<-tableresults[,c(1,2,4,10,11,12,13)]


captions=paste0("Static population model for ",country,". \nStarting year: ",last_year_available,", GDP Actual: ",gdp_char," BN")
knitr::kable(tableresults, caption = captions,align = c('c','c','c','r','r','c','r','r','r','r','r','r','r','r'))



```


In this first version of the model I aim simulate a **no population growth** [$\beta \equiv \textit{CAGR of (Population)}=0$] scenario where at the current **average GDP growth rate** [$\alpha \equiv \textit{CAGR of (GDP)}$] and the number of iterations (or Years) as stated in  `r t.ref("staticmodel")` columns 1 and 2 means that if the country continues for the number of years (in column 3) **having each year** those results it will end up with the figures in the rest of the columns (approximately US current GDP per capita).


\newpage

#### Dynamic Population Second Model 

```{r Model_PopulationGrowth,include=FALSE}
years=(log10(gdp_aim_fix)-log10(gdp_actual))/log10(1+GDPgrowth/100)
LVmod <- function(Time, State, Pars) {
  with(as.list(c(State, Pars)), {

    GrowthPop   <-  Grow_Pop * Population_Estimations #rnorm(1,Grow_Pop,Grow_Pop_var)
    incomegrw <- Grow_GDP_mean* GDP_Estimations #* (1 - GDP_Estimations/GDP_Aim_Fix) rnorm(1,Grow_GDP_mean,Grow_GDP_variance) 
    
    Population_Estimations  <- GrowthPop 
    GDP_Estimations <- incomegrw
    #cost    <- (income) * assEff + pricehospbed*beds + priceroadkm*roads
    
    return(list(c(Population_Estimations, GDP_Estimations)))
  })
}

pars  <- c(Grow_Pop  = populationgrowth,    # /day, growth rate of population
           Grow_Pop_var = populationgrowth_variance,
           Grow_GDP_mean  = GDPgrowth/100,
           Grow_GDP_variance = GDPvariance/100,
           GDP_Aim_Fix = gdp_aim_fix)

yini  <- c(Population_Estimations = population_actual, GDP_Estimations = gdp_actual)
times <- seq(2018, 2018 + as.integer(years)+1, by = 1)
out   <- ode(yini, times, LVmod, pars)
```


#### Results of dynamic population model

```{r, echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all'}
results<-as.data.frame(out,row.names = FALSE)
#ByProgram2$Balance_Promedio<-prettyNum(ByProgram2$Balance_Promedio,big.mark = ",",scientific=FALSE,digits=0)
p<-ggplot(data=results,mapping=aes(x=time,y=Population_Estimations))+geom_smooth(colour="dodgerblue4",size = .5)+geom_point(colour="dodgerblue4",size = .5)

p<-p+scale_colour_manual(values =c("dodgerblue4"))+scale_y_continuous(label = unit_format(unit = "MM", scale = 1e-6)) + labs(y="Population",x="Time (iteration)") + theme_bw(base_size = 8)
#+ylim(low=1500000000000, high=2500000000000)


c<-ggplot(data=results,mapping=aes(x=time,y=GDP_Estimations))+geom_smooth(colour="#EA5839",size = .5)+geom_point(colour="#EA5839",size = .5)
c<-c+scale_colour_manual(values =c("#EA5839")) +scale_y_continuous(label = unit_format(unit = "BN", scale = 1e-12,accuracy = .1))  + labs(y="GDP (2010 US$)",x="Time (iteration)") + theme_bw(base_size = 8)

i<-ggplot(data=results%>%mutate(GDP_x_Capita=GDP_Estimations/Population_Estimations),mapping=aes(x=time,y=GDP_x_Capita))+geom_smooth(colour="#313695",size = .5)+geom_point(colour="#313695",size = .5)
i<-i+scale_colour_manual(values =c("#313695")) +scale_y_continuous(label = unit_format(unit = "K", scale = 1e-3,accuracy = .1))  + labs(y="GDP per Capita Est",x="Time (iteration)") + theme_bw(base_size = 8)


grid.arrange(c,p,i,ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))

```

The results of this model captures the **average GDP growth rate** $(\alpha)$of this century. It's based on a growing population at current **average population growth rate** $(\beta)$. 

Under this circumstances the followings yields:

```{r dynamictable, fig.cap=table_captions("dynamictable", "")}
results<-results%>%mutate(GDP_x_Capita=GDP_Estimations/Population_Estimations)
labels<-c('CAGR (GDP)','CAGR (Pop)','Start year','Years (#)','Start GDP','Aim GDP','Last GDP x cap','Last Pop')
#labels<-c('Alpha','Beta','Start year','Years (#)','Start GDP','Aim GDP','Last GDP x cap','Last Pop')
gdp_capita_final<-(results%>%select(GDP_Estimations)%>%tail( n=1)%>%as.double())/results%>%select(Population_Estimations)%>%tail( n=1)%>%as.double()
pop_last<-results%>%filter(GDP_x_Capita<=gdp_capita_aim)%>%select(Population_Estimations)%>%tail( n=1)%>%as.double()
Assumptions<-c(round(GDPgrowth/100,digits = 3),round(populationgrowth,3),round(last_year_available),years,gdp_actual,gdp_aim_fix,gdp_capita_final,pop_last)
tableresults<-data.frame(Assumptions)
tableresults<-transpose(tableresults)%>%data.frame()
colnames(tableresults)<-labels
tableresults$`GDP BN (A)`<-prettyNum(tableresults$`Start GDP`/1000000000000,big.mark=",",scientific=FALSE,digits=3)
tableresults$`GDP BN (Est.)`<-prettyNum(tableresults$`Aim GDP`/1000000000000,big.mark=",",scientific=FALSE,digits=3)
tableresults$`GDP x Cap` <-prettyNum(tableresults$`Last GDP x cap`,big.mark=",",scientific=FALSE,digits=0)
tableresults$`GDP x Cap Grw` <-percent((tableresults$`Last GDP x cap`/gdp_x_capita_actual)-1)
tableresults$`Start year`<-as.integer(tableresults$`Start year`)
tableresults$`Years (#)`<-as.integer(tableresults$`Years (#)`)
tableresults$`Pop MM` <-prettyNum(tableresults$`Last Pop`/1000000,big.mark=",",scientific=FALSE,digits=0)
tableresults<-tableresults[,c(1,2,4,10,11,12,13)]
captions=paste0("Dynamic population model for ",country,". \nStarting year: ",last_year_available," GDP Actual: ",gdp_char," BN")
knitr::kable(tableresults, caption = captions,align = c('c','c','c','r','r','c','r','r','r','r','r','r','r','r'))


```


In this versions of the model I aim to simulate a baseline scenario at the current **average population growth rate** [$\alpha=\textit{CAGR of (GDP)}$] and   **average GDP growth rate** [$\beta=\textit{CAGR of (Population)}$] with the number of iterations (or Years) as stated in  `r t.ref("dynamictable")` columns 1 and 2 means that if the country continues for the number of years (in column 3) **having each year** those results it will end up with the figures in the rest of the columns.

In the following section I will run simulations based on a **stochastic model** for both **population** and **GDP growth rates**.



\newpage

### Stochastic models

#### Dynamic Stochastic growth on population and GDP

In this part of the study I use a dynamic system where $\alpha$ and $\beta$ behaives as follow:

$$\alpha \sim N(\mu_{\dot{GDP}},\sigma_{\dot{GDP}})$$

$$\beta \sim N(\mu_{\dot{Pop}},\sigma_{\dot{Pop}})$$

This means that in each iteration/year the growth rate will be the realization of the propose distribution for each random variable.

#### Results of Simulation

```{r Model_PopulationGrowth_advance_old,warning=FALSE,message=FALSE,include=FALSE,eval=FALSE}
df_total = data.frame()
years=(log10(gdp_aim_fix)-log10(gdp_actual))/log10(1+GDPgrowth/100)
#g=0
interval = seq(from = 0, to = 100, by = 1)
for(i in interval){
  #g=g+1
  LVmod <- function(Time, State, Pars) {
    with(as.list(c(State, Pars)), {
  
    GrowthPop   <-  rnorm(1,Grow_Pop,Grow_Pop_var) * Population_Estimations
    incomegrw <- rnorm(1,Grow_GDP_mean,Grow_GDP_variance) * GDP_Estimations #* (1 - GDP_Estimations/GDP_Aim_Fix)
      
      Population_Estimations  <- GrowthPop 
      GDP_Estimations <- incomegrw
      #cost    <- (income) * assEff + pricehospbed*beds + priceroadkm*roads
      
      return(list(c(Population_Estimations, GDP_Estimations)))
    })
  }
  
  pars  <- c(Grow_Pop  = populationgrowth,    # /day, growth rate of population
             Grow_Pop_var = populationgrowth_variance,    # /day, growth rate of population 
             Grow_GDP_mean  = (GDPgrowth)/100, #+(i/10)
             Grow_GDP_variance = GDPvariance/100,
             GDP_Aim_Fix = gdp_aim_fix)
  
  yini  <- c(Population_Estimations = population_actual, GDP_Estimations = gdp_actual)
  times <- seq(2018, 2018 + as.integer(years)+1, by = 1)
  out   <- ode(yini, times, LVmod, pars)  
  results<-as.data.frame(out,row.names = FALSE)
  ##VER##
  results<-results%>%mutate(GDP_x_Capita=GDP_Estimations/Population_Estimations)
  assign(paste0("Base",i),results)
  labels<-c('Simulation','Start year','Years (#)','Start GDP','Final GDP','Last GDP x cap','Last Pop')
  #Simulation<-paste0("# ",i)
  #
  gdp_capita_final<-(results%>%filter(GDP_x_Capita<=gdp_capita_aim & GDP_Estimations > gdp_actual*.8)%>%select(GDP_x_Capita)%>%tail( n=1)%>%as.double())
  
  gdp_final<-results%>%filter(GDP_x_Capita<=gdp_capita_aim & GDP_Estimations > gdp_actual*.8)%>%select(GDP_Estimations)%>%tail( n=1)%>%as.double()
  
  years_factual<-results%>%filter(GDP_x_Capita<=gdp_capita_aim & GDP_Estimations > gdp_actual*.8)%>%select(time)%>%tail( n=1)%>%as.double()
  
  #pop_factual<-results%>%filter(GDP_x_Capita<=gdp_capita_aim)%>%select(Population_Estimations)%>%tail( n=1)%>%as.double()
  
  pop_last<-results%>%filter(GDP_x_Capita<=gdp_capita_aim & GDP_Estimations > gdp_actual*.8)%>%select(Population_Estimations)%>%tail( n=1)%>%as.double()
  
  Assumptions<-c(paste0("# ",i),round(last_year_available),years_factual,gdp_actual,gdp_final,gdp_capita_final,pop_last)
  tableresults<-data.frame('Simulation','Start year','Years (#)','Start GDP','Final GDP','Last GDP x cap','Last Pop',  # as many cols as you need
                 stringsAsFactors=FALSE)
  tableresults[1,]<-list(paste0("# ",i),round(last_year_available),years_factual,gdp_actual,gdp_final,gdp_capita_final,pop_last)
  #tableresults<-transpose(tableresults)%>%data.frame()
  colnames(tableresults)<-labels

  
 tableresults$`Start GDP`<-as.double(tableresults$`Start GDP`)
 tableresults$`Final GDP`<-as.double(tableresults$`Final GDP`)
 tableresults$`Last GDP x cap`<-as.double(tableresults$`Last GDP x cap`)
 tableresults$`GDP x Cap Growth`<-(as.double(tableresults$`Last GDP x cap`)/gdp_x_capita_actual)-1
 tableresults$`Last Pop`<-as.double(tableresults$`Last Pop`)
 tableresults$`Start year`<-as.integer(as.double(tableresults$`Start year`))
 tableresults$`Years (#)`<-as.integer(as.double(tableresults$`Years (#)`))-last_year_available
 
  #assign(paste0("SummaryResults",g),tableresults%>%select(-`Start GDP`,-`Final GDP`,-`Last Pop`,-`Start year`))
 #%>%select(-`Start GDP`,-`Final GDP`,-`Last Pop`,-`Start year`,-`Last GDP x cap`)
  df_total <- rbind(df_total,tableresults)
  assign(paste0("SummaryResults"),df_total)
  #captions=paste0("Dynamic population model for ",country)
}

#rm(list=ls(pattern="^SummaryResults"))
#rm(list=ls(pattern="^Base"))
#SummaryResults<-SummaryResults [,c(1,2,3,5,6,7,8)]
Present<-SummaryResults

#tableresults$`Start GDP BN`<-prettyNum(as.double(tableresults$`Start GDP`)/1000000000000,big.mark=",",scientific=FALSE,digits=3)
Present$`GDP BN`<-prettyNum(SummaryResults$`Final GDP`/1000000000000,big.mark=",",scientific=FALSE,digits=3)
Present$`GDP x cap` <-prettyNum(SummaryResults$`Last GDP x cap`,big.mark=",",scientific=FALSE,digits=0)
Present$`GDP x Cap Growth` <-percent(SummaryResults$`Last GDP x cap`/gdp_x_capita_actual-1)
Present$`Pop MM` <-prettyNum(SummaryResults$`Last Pop`/1000000,big.mark=",",scientific=FALSE,digits=0)
  #tableresults$`Start year`<-as.integer(as.double(tableresults$`Start year`))


captions=paste0("Stochastic simulations to the dynamic population model for ",country,".\n GDP Actual: ",gdp_char," BN on the year ",last_year_available)

```



```{r Model_PopulationGrowth_advance,warning=FALSE,message=FALSE,include=FALSE,eval=TRUE}
results_total = data.frame()
years=(log10(gdp_aim_fix)-log10(gdp_actual))/log10(1+GDPgrowth/100)
#g=0
numhist<-10000
interval = seq(from = 1, to = numhist, by = 1)
for(i in interval){
  #g=g+1
  LVmod <- function(Time, State, Pars) {
    with(as.list(c(State, Pars)), {
  
    GrowthPop   <-  rnorm(1,Grow_Pop,Grow_Pop_var) * Population_Estimations
    incomegrw <- rnorm(1,Grow_GDP_mean,Grow_GDP_variance) * GDP_Estimations #* (1 - GDP_Estimations/GDP_Aim_Fix)
      
      Population_Estimations  <- GrowthPop 
      GDP_Estimations <- incomegrw
      #cost    <- (income) * assEff + pricehospbed*beds + priceroadkm*roads
      
      return(list(c(Population_Estimations, GDP_Estimations)))
    })
  }
  
  pars  <- c(Grow_Pop  = populationgrowth,    # /day, growth rate of population
             Grow_Pop_var = populationgrowth_variance,    # /day, growth rate of population 
             Grow_GDP_mean  = (GDPgrowth)/100, #+(i/10)
             Grow_GDP_variance = GDPvariance/100,
             GDP_Aim_Fix = gdp_aim_fix)
  
  yini  <- c(Population_Estimations = population_actual, GDP_Estimations = gdp_actual)
  times <- seq(2018, 2018 + as.integer(years)+1, by = 1)
  out   <- ode(yini, times, LVmod, pars)  
  results<-as.data.frame(out,row.names = FALSE)
  ##VER##
  results<-results%>%mutate(GDP_x_Capita=GDP_Estimations/Population_Estimations,Scenario=paste0("Simulation ",i))
  results_total <- rbind(results_total,results)
  #assign(paste0("ResultSimulations"),results_total)
  #labels<-c('Simulation','Start year','Years (#)','Start GDP','Final GDP','Last GDP x cap','Last Pop')
  #Simulation<-paste0("# ",i)
  #
  #gdp_capita_final<-(results%>%filter(GDP_x_Capita<=gdp_capita_aim & GDP_Estimations > gdp_actual*.8)%>%select(GDP_x_Capita)%>%tail( n=1)%>%as.double())
  
  #gdp_final<-results%>%filter(GDP_x_Capita<=gdp_capita_aim & GDP_Estimations > gdp_actual*.8)%>%select(GDP_Estimations)%>%tail( n=1)%>%as.double()
  
  #years_factual<-results%>%filter(GDP_x_Capita<=gdp_capita_aim & GDP_Estimations > gdp_actual*.8)%>%select(time)%>%tail( n=1)%>%as.double()
  
  #pop_factual<-results%>%filter(GDP_x_Capita<=gdp_capita_aim)%>%select(Population_Estimations)%>%tail( n=1)%>%as.double()
  
  #pop_last<-results%>%filter(GDP_x_Capita<=gdp_capita_aim & GDP_Estimations > gdp_actual*.8)%>%select(Population_Estimations)%>%tail( n=1)%>%as.double()
  
  #Assumptions<-c(paste0("# ",i),round(last_year_available),years_factual,gdp_actual,gdp_final,gdp_capita_final,pop_last)
  #tableresults<-data.frame('Simulation','Start year','Years (#)','Start GDP','Final GDP','Last GDP x cap','Last Pop',  # as many cols as you need
  #               stringsAsFactors=FALSE)
  #tableresults[1,]<-list(paste0("# ",i),round(last_year_available),years_factual,gdp_actual,gdp_final,gdp_capita_final,pop_last)
  #tableresults<-transpose(tableresults)%>%data.frame()
  #colnames(tableresults)<-labels

  
 #tableresults$`Start GDP`<-as.double(tableresults$`Start GDP`)
 #tableresults$`Final GDP`<-as.double(tableresults$`Final GDP`)
 #tableresults$`Last GDP x cap`<-as.double(tableresults$`Last GDP x cap`)
 #tableresults$`GDP x Cap Growth`<-(as.double(tableresults$`Last GDP x cap`)/gdp_x_capita_actual)-1
 #tableresults$`Last Pop`<-as.double(tableresults$`Last Pop`)
 #tableresults$`Start year`<-as.integer(as.double(tableresults$`Start year`))
 #tableresults$`Years (#)`<-as.integer(as.double(tableresults$`Years (#)`))-last_year_available
 
  #assign(paste0("SummaryResults",g),tableresults%>%select(-`Start GDP`,-`Final GDP`,-`Last Pop`,-`Start year`))
 #%>%select(-`Start GDP`,-`Final GDP`,-`Last Pop`,-`Start year`,-`Last GDP x cap`)
  #df_total <- rbind(df_total,tableresults)
  #assign(paste0("SummaryResults"),df_total)
  #captions=paste0("Dynamic population model for ",country)
}

#rm(list=ls(pattern="^SummaryResults"))
#rm(list=ls(pattern="^Base"))
#SummaryResults<-SummaryResults [,c(1,2,3,5,6,7,8)]
#left_join(results_total,results_total%>%group_by(Scenario)%>%dplyr::summarise(lastyear=max(time)))
#Present<-results_total%>%filter(time==(2018 + as.integer(years)+1) & GDP_x_Capita>=.5*gdp_x_capita_actual & GDP_x_Capita<=10*gdp_x_capita_actual)
Present<-left_join(results_total,results_total%>%group_by(Scenario)%>%dplyr::summarise(lastyear=max(time)))%>%filter(time==lastyear & GDP_x_Capita>=.5*gdp_x_capita_actual & GDP_x_Capita<=100*gdp_x_capita_actual)

#tableresults$`Start GDP BN`<-prettyNum(as.double(tableresults$`Start GDP`)/1000000000000,big.mark=",",scientific=FALSE,digits=3)
Present$`GDP BN`<-prettyNum(Present$GDP_Estimations/1000000000000,big.mark=",",scientific=FALSE,digits=3)
Present$`GDP x cap` <-prettyNum(Present$GDP_x_Capita,big.mark=",",scientific=FALSE,digits=0)
Present$`GDP x Cap Growth` <-percent(Present$GDP_x_Capita/gdp_x_capita_actual-1)
Present$`Pop MM` <-prettyNum(Present$Population_Estimations/1000000,big.mark=",",scientific=FALSE,digits=0)
  #tableresults$`Start year`<-as.integer(as.double(tableresults$`Start year`))
Present$time<-prettyNum(Present$time,big.mark="",scientific=FALSE,digits=0)

captions=paste0("Stochastic simulations to the dynamic population model for ",country,".\n GDP Actual: ",gdp_char," BN on the year ",last_year_available)

```

`r t.ref("stochastictable")` shows the final year result of a hundred random runs of the model. Model was runned *10,000* times.

```{r stochastictable, fig.cap=table_captions("stochastictable", "")}
knitr::kable(Present%>%arrange(desc(GDP_x_Capita))%>%select(Scenario,time,`GDP BN`,`Pop MM`,`GDP x cap`,`GDP x Cap Growth`)%>%sample_n(100), caption = captions,align = c('c','c','r','r','r','r','r'))
```


Each time it is run model iterates the growth rates for **GDP** and **Population** at maximum the number of times (years) necessary for reaching the **GDP per capita aim** level  at the cero population growth rate model in  `r t.ref("staticmodel")`. And it will stop whenever it reaches that level of **GDP per capita** or whenever the **GDP per capita** drops to 50% of its starting level.

Each run of the model represent a hipotetic history line. In the following figures I present the dynamics for a **random sample of 10 histories**. This makes possible to track year after year how the histories behaive in terms of the mixed realization of $\alpha$ and $\beta$ in each iteration/year, ending up with a highest or lowest **GDP per capita**  level.  `r f.ref("toptengraph_pop")`, `r f.ref("toptengraph_gdp")` and `r f.ref("toptengraph_gdp_cap")` summarizes the dinamycs in each of the histories.



\newpage





```{r toptengraph_pop,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Population Dynamics random sample 10 results (out of 10,000) 73 iterations/years"}
Auxiliar<-Present%>%arrange(desc(GDP_x_Capita))%>%mutate(ID= seq.int(nrow(Present))) 
#sample_n(df, 10)
#inner_join(results_total,sample_n(Auxiliar, 10)%>%select(Scenario,ID))%>%arrange(ID)
p<-ggplot(data=inner_join(results_total,sample_n(Auxiliar, 10)%>%select(Scenario,ID))%>%arrange(ID),mapping=aes(x=time,y=Population_Estimations))+geom_smooth(colour="dodgerblue4",size = .1)+geom_point(colour="dodgerblue4",size = .2) +scale_colour_manual(values =c("dodgerblue4"))+scale_y_continuous(label = unit_format(unit = "MM", scale = 1e-6)) + labs(y="Population",x="Time") + theme_bw(base_size = 10)+facet_wrap(~Scenario, scales = "free",ncol = 3)
p

```


```{r toptengraph_gdp,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP Dynamics random sample 10 results (out of 10,000) 73 iterations/years"}
q<-ggplot(data=inner_join(results_total,sample_n(Auxiliar, 10)%>%select(Scenario,ID))%>%arrange(ID),mapping=aes(x=time,y=GDP_Estimations))+geom_smooth(colour="#EA5839",size = .1)+geom_point(colour="#EA5839",size = .2) +scale_colour_manual(values =c("#EA5839")) +scale_y_continuous(label = unit_format(unit = "BN", scale = 1e-12,accuracy = .1))  + labs(y="GDP (US$)",x="Time") + theme_bw(base_size = 10)+facet_wrap(~Scenario, scales = "free",ncol = 3)
q
```


```{r toptengraph_gdp_cap,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="GDP x Capita Dynamics random sample 10 results (out of 10,000) 73 iterations/years"}
r<-ggplot(data=inner_join(results_total,sample_n(Auxiliar, 10)%>%select(Scenario,ID))%>%arrange(ID),mapping=aes(x=time,y=GDP_x_Capita))+geom_smooth(colour="#313695",size = .1)+geom_point(colour="#313695",size = .2)+scale_colour_manual(values =c("#313695")) +scale_y_continuous(label = unit_format(unit = "K", scale = 1e-3,accuracy = .1))  + labs(y="GDP x Cap",x="Time") + theme_bw(base_size = 10)+facet_wrap(~Scenario, scales = "free",ncol = 3)
r
```


In `r f.ref("toptengraph_pop")`, `r f.ref("toptengraph_gdp")` and `r f.ref("toptengraph_gdp_cap")` we can see scenarios where **GDP per capita** growth to the **GDP per capita aim** at or before the iteration/years boundary. Or scenarios where the iteration/years boundary elapsed and the **GDP per capita**  did not raise to **aimed** level.  

\newpage



```{r, echo=FALSE,include=FALSE}
histlist = list()
hist_data = data.frame()
j=0
#times <- seq(2018, 2018 + as.integer(years)+1, by = 1) , aes(fill=..count..)+ scale_fill_gradient("Count", low = "green", high = "red")  + labs(title=paste0("Histogram GDP per capita of simulations in year: ",i))
for(i in seq(2018, 2018 + as.integer(years)+1, by = 1)){
  j=j+1
  helper <- results_total%>%filter(time==i)
  a<-min(Present$GDP_x_Capita)
  b<-max(Present$GDP_x_Capita)
  p<-ggplot(data=helper, aes(GDP_x_Capita)) + geom_histogram( breaks=seq(a, b, by =1000),col="red",fill="white") +scale_x_continuous(labels = scales::comma) +
  labs(x=paste0("GDP per capita USD in ",i), y="Count") + theme_bw(base_size = 5)
  assign(paste0("Histogram of year ",i),p)
  histlist[j] <- paste0("Histogram of year ",i) # add it to your list
  pg <- ggplot_build(p)
  resultshist<-pg$data[[1]]
  resultshist<-resultshist%>%mutate(probabilidad=count/sum(resultshist$count),minGDPxCapWeighted=probabilidad*xmin,maxGDPxCapWeighted=probabilidad*xmax,avgGDPxCapWeighted=probabilidad*x,Year=i)
  hist_data <- rbind(hist_data,resultshist)
  
}
graphslist_1 = list()
graphslist_2 = list()
graphslist_3 = list()
graphslist_4 = list()
graphslist_5 = list()
graphslist_6 = list()
graphslist_7 = list()
graphslist_8 = list()
i=1
for(m in 1:as.integer(j/8)){
  #grid.arrange(get(gdplist[[m]]),get(poplist[[m]]),get(gdp_x_cap_list[[m]]),ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))
  graphslist_1[[i]] <- get(histlist[[m]])
  i=i+1
}
i=1
for(m in (as.integer(j/8)+1):as.integer(2*j/8)){
  #grid.arrange(get(gdplist[[m]]),get(poplist[[m]]),get(gdp_x_cap_list[[m]]),ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))
  graphslist_2[[i]] <- get(histlist[[m]])
  i=i+1
}
i=1
for(m in (as.integer(2*j/8)+1):as.integer(3*j/8)){
  #grid.arrange(get(gdplist[[m]]),get(poplist[[m]]),get(gdp_x_cap_list[[m]]),ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))
  graphslist_3[[i]] <- get(histlist[[m]])
  i=i+1
}
i=1
for(m in (as.integer(3*j/8)+1):as.integer(4*j/8)){
  #grid.arrange(get(gdplist[[m]]),get(poplist[[m]]),get(gdp_x_cap_list[[m]]),ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))
  graphslist_4[[i]] <- get(histlist[[m]])
  i=i+1
}
i=1
for(m in (as.integer(4*j/8)+1):as.integer(5*j/8)){
  #grid.arrange(get(gdplist[[m]]),get(poplist[[m]]),get(gdp_x_cap_list[[m]]),ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))
  graphslist_5[[i]] <- get(histlist[[m]])
  i=i+1
}
i=1
for(m in (as.integer(5*j/8)+1):as.integer(6*j/8)){
  #grid.arrange(get(gdplist[[m]]),get(poplist[[m]]),get(gdp_x_cap_list[[m]]),ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))
  graphslist_6[[i]] <- get(histlist[[m]])
  i=i+1
}
i=1
for(m in (as.integer(6*j/8)+1):as.integer(7*j/8)){
  #grid.arrange(get(gdplist[[m]]),get(poplist[[m]]),get(gdp_x_cap_list[[m]]),ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))
  graphslist_7[[i]] <- get(histlist[[m]])
  i=i+1
}
i=1
for(m in (as.integer(7*j/8)+1):as.integer(8*j/8)){
  #grid.arrange(get(gdplist[[m]]),get(poplist[[m]]),get(gdp_x_cap_list[[m]]),ncol=1,top = textGrob("Results: dynamic population model",gp=gpar(fontsize=10,font=3)))
  graphslist_8[[i]] <- get(histlist[[m]])
  i=i+1
}

```

```{r primeros9,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Histogram results for period 2018 to 2026"}
#histlist[[1]]
do.call(grid.arrange, c(graphslist_1, ncol=4))
```

```{r segundos9,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Histogram results for period 2027 to 2035"}
#histlist[[1]]
do.call(grid.arrange, c(graphslist_2, ncol=4))
```

```{r third9,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Histogram results for period 2036 to 2045"}
#histlist[[1]]
do.call(grid.arrange, c(graphslist_3, ncol=4))
```

```{r forth9,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Histogram results for period 2046 to 2054"}
#histlist[[1]]
do.call(grid.arrange, c(graphslist_4, ncol=4))
```


```{r fifth9,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Histogram results for period 2055 to 2063"}
#histlist[[1]]
do.call(grid.arrange, c(graphslist_5, ncol=4))
```

```{r sixth9,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Histogram results for period 2064 to 2073"}
#histlist[[1]]
do.call(grid.arrange, c(graphslist_6, ncol=4))
```

```{r seventh9,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Histogram results for period 2074 to 2082"}
#histlist[[1]]
do.call(grid.arrange, c(graphslist_7, ncol=4))
```

```{r last9,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Histogram results for period 2083 to 2092"}
#histlist[[1]]
do.call(grid.arrange, c(graphslist_8, ncol=4))
```


```{r, echo=FALSE}
results_hist<-hist_data%>%group_by(Year)%>%dplyr::summarise(minGDPxCapWeighted=sum(minGDPxCapWeighted),avgGDPxCapWeighted=sum(avgGDPxCapWeighted),maxGDPxCapWeighted=sum(maxGDPxCapWeighted))
```


```{r summaryofsimmulations,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Summary of simulations for a 100 iterations of the model for 73 years"}
p<-ggplot(data=results_hist,mapping=aes(x=Year,y=maxGDPxCapWeighted))+geom_smooth(colour="dodgerblue4",size = .1)+geom_point(colour="dodgerblue4",size = .2) +scale_colour_manual(values =c("dodgerblue4"))+scale_y_continuous(label = scales::comma) + labs(y="Maximum",x="Time") + theme_bw(base_size = 10)
#p
q<-ggplot(data=results_hist,mapping=aes(x=Year,y=avgGDPxCapWeighted))+geom_smooth(colour="green",size = .1)+geom_point(colour="green",size = .2) +scale_colour_manual(values =c("green"))+scale_y_continuous(label = scales::comma) + labs(y="Average",x="Time") + theme_bw(base_size = 10)
#q
r<-ggplot(data=results_hist,mapping=aes(x=Year,y=minGDPxCapWeighted))+geom_smooth(colour="red",size = .1)+geom_point(colour="red",size = .2) +scale_colour_manual(values =c("red"))+scale_y_continuous(label = scales::comma) + labs(y="Minimum",x="Time") + theme_bw(base_size = 10)
#r
grid.arrange(p,q,r,ncol=1)
```



```{r oro,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Summary of simulations (other view)"}
#f <- data.frame(x, y1, y2)
ggplot(results_hist, aes(Year, y = value, color = variable)) + 
    geom_point(aes(y = minGDPxCapWeighted, col = "Min"),size = .5) + 
    geom_point(aes(y = avgGDPxCapWeighted, col = "Avg"),size = .5)+ 
    geom_point(aes(y = maxGDPxCapWeighted, col = "Max"),size = .5)+ labs(y="GDP x Capita",x="Time",col="Interval") + theme_bw(base_size = 8)
```



```{r finalyear}
p<-ggplot(data=Present, aes(GDP_x_Capita)) + geom_histogram( breaks=seq(min(Present$GDP_x_Capita), max(Present$GDP_x_Capita), by =1000),col="red", aes(fill=..count..)) + scale_fill_gradient("Count", low = "green", high = "red")+scale_x_continuous(labels = scales::comma) + 
  labs(title="Histogram for Final GDP per capita of simulations") +
  labs(x="GDP per capita USD", y="Count")
#labels = scales::number_format(accuracy = 0.01) label = unit_format(unit = "K", scale = 1e-3,accuracy = .1) labels = scales::comma
#aes(y =..density..) + geom_density(col=2)
#ggplot(data=SummaryResults, aes(SummaryResults$`Last GDP x cap`)) + geom_histogram( breaks=seq(0, 50000, by =1000),col="red", aes(fill=..count..)) + scale_fill_gradient("Count", low = "green", high = "red")+scale_x_continuous(labels = scales::comma)
#min(Present$GDP_x_Capita)
#+scale_y_continuous(labels = scales::number_format())

```




```{r echo=FALSE}
ggplot(data=Present, aes(GDP_x_Capita)) + 
  geom_histogram(aes(y =..density..), 
                 breaks=seq(min(Present$GDP_x_Capita), max(Present$GDP_x_Capita), by =1000), 
                 col="red", 
                 fill="white", 
                 alpha = .2) + 
  geom_density(col=2) + 
  labs(title="Density distribution for Final GDP per capita simulations") +
  labs(x="GDP per capita USD", y="Density")+scale_x_continuous(labels = scales::comma)
```

```{r resultsofsimmulationsgraphicallastyear,echo=FALSE,warning=FALSE,results='hide',message=FALSE,fig.keep='all', fig.cap="Last Year: GDP x capita"}
pg <- ggplot_build(p)
#pg$plot$data
resultshist<-pg$data[[1]]
resultshist<-resultshist%>%mutate(probabilidad=count/sum(resultshist$count),minGDPxCapWeighted=probabilidad*xmin,maxGDPxCapWeighted=probabilidad*xmax,avgGDPxCapWeighted=probabilidad*x)
#resultshist%>%group_by()%>%summarise(Densidad=sum(probabilidad))
#quantile(resultshist$probabilidad)

Mean<-c(sum(resultshist$minGDPxCapWeighted),sum(resultshist$avgGDPxCapWeighted),sum(resultshist$maxGDPxCapWeighted))

modemax<-resultshist%>%filter(count==max(resultshist$count, na.rm=T))%>%select(xmax)%>%as.double()
modeavg<-resultshist%>%filter(count==max(resultshist$count, na.rm=T))%>%select(x)%>%as.double()
modemin<-resultshist%>%filter(count==max(resultshist$count, na.rm=T))%>%select(xmin)%>%as.double()
Mode<-c(modemin,modeavg,modemax)
#quantile(resultshist$x,resultshist$probabilidad)
Type<-c('Minimum','Average','Maximum')
summaryoflastyear<-data.frame(Type,Mean,Mode)
#resultshist%>%mutate(CumProb=probabilidad)
#md%>%filter(`Series Name`=="Population, total") %>% group_by(`Country Name`) %>% mutate(populationgrowth = (value - lag(value))/lag(value))%>%filter(`Country Name`==country)%>%group_by()%>%summarise(populationgrowth=mean(populationgrowth,na.rm = TRUE))%>%as.double()
summaryoflastyear$Mean <-prettyNum(summaryoflastyear$Mean,big.mark=",",scientific=FALSE,digits=0)
summaryoflastyear$Mode <-prettyNum(summaryoflastyear$Mode,big.mark=",",scientific=FALSE,digits=0)

p+ geom_vline(xintercept = sum(resultshist$avgGDPxCapWeighted), linetype=2, 
                color = "black", size=.5)+ geom_vline(xintercept = sum(resultshist$minGDPxCapWeighted), linetype=1, 
                color = "black", size=.3)+ geom_vline(xintercept = sum(resultshist$maxGDPxCapWeighted), linetype=1, 
                color = "black", size=.3)+ geom_vline(xintercept = sum(modeavg), linetype=2, 
                color = "yellow", size=.5)+ geom_vline(xintercept = sum(modemin), linetype=1, 
                color = "yellow", size=.5)+ geom_vline(xintercept = sum(modemax), linetype=1, 
                color = "yellow", size=.5)
```


```{r summaryresultsofmodel, fig.cap=table_captions("summaryresultsofmodel", "")}
#prettyNum(years,big.mark=",",scientific=FALSE,digits=0)
#as.integer(years)
#numhist
captions<-paste0("Histories aggregation results after ",prettyNum(numhist,big.mark=",",scientific=FALSE,digits=0), " histories/simulations over ",prettyNum(years,big.mark=",",scientific=FALSE,digits=0)," years")
knitr::kable(summaryoflastyear, caption = captions,align = c('l','r','r'))
```

## Conclusions to GDP, growth and inequality

In this section and the prior one we have summarized the results of models and estimations, all of them around questions about development, inequallity and economic growth. 

In section **GDP & GNI per Capita estimations** in `r t.ref("Income_shr_10_l")` we can see that, if meant to be born on the *lowest 10'th of the population*, it is *better* to be born in a country such as Norway where the estimations mean that citizens of that country living at the *lowest 10'th of the population*, lives in average with a yearly ammount of $16,044$ usd or 3.65\% of it's GDP. Whereas in the american continent, the same *lowest 10'th of the population* in the United States lives with an average yearly ammount of $4,249$ usd (1.73\% of it's GDP), in Chile they live with an average  yearly ammount of $1,046$ usd (1.66\% of it's GDP). And, in Mexico the *lowest 10'th of the population* lives with - just - an average yearly ammount of $847$ usd (1.83\% of it's GDP). The insights extracted from it let us think that even if less equal people living in the *lowest 10'th of the population* in countries such as Norway (in Europe), United States (in North America) or even Chile (in South America) lives in average less poor or with more access to goods and services than people of the *lowest 10'th of the population* in Mexico (North America). Makeing simple maths income shared held by *lowest 10'th of the population* in Norway is about $1.99(=\frac{3.65\%}{1.83\%})$ times bigger than Mexico, however given their current **GDP** and **Population** level GDP held by *lowest 10'th of the population* estimations are $18.94(=\frac{16,044}{847})$ times bigger than the one in Mexico.

In section **GDP and Population** we proposed a simple model based on normal distributions for **GDP** and **Population growth**. The aim of this section is to simulate scenarios based in this century averages and standard deviations, where I tried to solved the question, in how many years does Mexico will develop a **GDP** level greater enough, relatively to the **Population**, to address a **GDP per capita** similar to the current level of Mexico's northern neighbor. In the proposed approach we identified two base scenarios, one with zero population growth rate as seen in `r t.ref("staticmodel")` where the main insight is that at the average growth rate of the century it would take about 73 years. And, the second one where I incorporate also the average growth rate of the century to population and find out that after 73 years Mexico will meet a 79% higher **GDP per capita** that the current level. Finally, stochastic models shows simulations that incorporate the fact that economy might suffer upgrades or downgrades above and below the average level during the following 73 years.

As a summary of this sections the following question becomes particularly important: What is more urgent for an economy like Mexico, to increase *average participation/share* of the  *lowest quintiles of the population* in the **GDP** or to increase  its **GDP** to a level equivalent to the one held by countries such as Norway or the United States as seen in `r t.ref("firstapproach")`?

In `r t.ref("summaryresultsofmodel")` it is possible to see the results for the model run over a $10,000$ scenarios over $73$ years/iterations each.  

\newpage

## Interest rate spread (lending rate minus deposit rate, %)

Interest rate spread is the interest rate charged by banks on loans to private sector customers minus the interest rate paid by commercial or similar banks for demand, time, or savings deposits. The terms and conditions attached to these rates differ by country, however, limiting their comparability.

The interest rate spread - the margin between the cost of mobilizing liabilities and the earnings on assets - measures financial sector efficiency in intermediation. A narrow spread means low transaction costs, which reduces the cost of funds for investment, crucial to economic growth.

```{r Interestratespread, fig.cap=table_captions("Interestratespread", "") }
knitr::kable(statis%>%filter(`Series Name`=="Interest rate spread (lending rate minus deposit rate, %)"&!is.na(Mean))%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Interest rate spread (lending rate minus deposit rate, %) period 2000 - 2017")
```

```{r interestratespread_1, echo=FALSE,warning=FALSE,fig.cap="Boxplot interest rates 2000 - 2017 "}
md %>% filter(`Series Name`=="Interest rate spread (lending rate minus deposit rate, %)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Interest rate spread (%)",x="Country Code") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Interest rate spread (lending rate minus deposit rate, %)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

## Deposit interest rate (%)

Deposit interest rate is the rate paid by commercial or similar banks for demand, time, or savings deposits. The terms and conditions attached to these rates differ by country, however, limiting their comparability.

Many interest rates coexist in an economy, reflecting competitive conditions, the terms governing loans and deposits, and differences in the position and status of creditors and debtors. In some economies interest rates are set by regulation or administrative fiat. In economies with imperfect markets, or where reported nominal rates are not indicative of effective rates, it may be difficult to obtain data on interest rates that reflect actual market transactions. Deposit and lending rates are collected by the International Monetary Fund (IMF) as representative interest rates offered by banks to resident customers. The terms and conditions attached to these rates differ by country, however, limiting their comparability.

```{r Depositinterestrate(%), fig.cap=table_captions("Depositinterestrate(%)", "")}
knitr::kable(statis%>%filter(`Series Name`=="Deposit interest rate (%)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Deposit interest rate (%)")
```

```{r depositsinterestrate, echo=FALSE,warning=FALSE,fig.cap="Trendline interest rates 2000 - 2017 "}
md %>% filter(`Series Name`=="Deposit interest rate (%)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Deposit interest rate (%)",x="Country Code") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Deposit interest rate (%)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

\newpage

## Inflation, consumer prices (annual %)

```{r inflationrate(%), fig.cap=table_captions("inflationrate(%)", "")}
knitr::kable(statis%>%filter(`Series Name`=="Inflation, consumer prices (annual %)")%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Inflation, consumer prices (annual %)")
```

```{r inflationrategraph, echo=FALSE,warning=FALSE,fig.cap="Boxplot inflation rates 2000 - 2017 "}
md %>% filter(`Series Name`=="Inflation, consumer prices (annual %)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Inflation, consumer prices (annual %)",x="Country Code") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Inflation, consumer prices (annual %)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

\newpage

## Bank capital to assets ratio (%)

Bank capital to assets is the ratio of bank capital and reserves to total assets. Capital and reserves include funds contributed by owners, retained earnings, general and special reserves, provisions, and valuation adjustments. Capital includes tier 1 capital (paid-up shares and common stock), which is a common feature in all countries' banking systems, and total regulatory capital, which includes several specified types of subordinated debt instruments that need not be repaid if the funds are required to maintain minimum capital levels (these comprise tier 2 and tier 3 capital). Total assets include all nonfinancial and financial assets.

The ratio of capital to total assets, without the latter being risk weighted. Capital is measured as total capital and reserves as reported in the sectoral balance sheet; for cross-border consolidated data, Tier 1 capital can also be used. It indicates the extent to which assets are funded by other than own funds and is a measure of capital adequacy of the deposit-taking sector. It complements the capital adequacy ratios compiled based on the methodology agreed to by the Basle Committee on Banking Supervision. Also, it measures financial leverage and is sometimes called the leverage ratio. Data are submitted by national authorities to the IMF following the Financial Soundness Indicators (FSI) Compilation Guide. For country specific metadata, including reporting period, please refer to the GFSR FSI Tables and the Data and Metadata Tables available through FSIs website: http://fsi.imf.org/.

```{r bankcapitaltoasset(%), fig.cap=table_captions("bankcapitaltoasset(%)", "")}
knitr::kable(statis%>%filter(`Series Name`=="Bank capital to assets ratio (%)"&!is.na(Mean))%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Bank capital to assets ratio (%)")
```

\newpage

```{r banktoassetratio_graph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline bank capital to assets ratios 2000 - 2017 non aggregated"}

ggplot(data=md%>%filter(`Series Name`=="Bank capital to assets ratio (%)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Bank capital to assets ratio (%)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r banktoassetsratio_graph_AGRR,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline bank capital to assets ratios 2000 - 2017 aggregated and biggest economies"}

ggplot(data=md%>%filter(`Series Name`=="Bank capital to assets ratio (%)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Bank capital to assets ratio (%)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r banktoassetratio_graph2, echo=FALSE,warning=FALSE,fig.cap="Boxplot bank capital to assets ratios 2000 - 2017"}
md %>% filter(`Series Name`=="Bank capital to assets ratio (%)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Inflation, consumer prices (annual %)",x="Country Code") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Bank capital to assets ratio (%)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

\newpage

## Current account balance (% of GDP)

Current account balance is the sum of net exports of goods and services, net primary income, and net secondary income.

```{r cab, echo=FALSE,warning=FALSE,fig.cap=table_captions("cab", "")}

# Goods and services expense (% of expense)

knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Current account balance (% of GDP)"  & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Current account balance (% of GDP)")
```


```{r cab_graph1, echo=FALSE,warning=FALSE,fig.cap="Boxplot Current Account Balance 2000 - 2017"}
md %>% filter(`Series Name`=="Current account balance (% of GDP)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Current account balance (% of GDP)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Current account balance (% of GDP)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```


```{r cab_graph2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Current Account Balance 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Current account balance (% of GDP)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Current account balance (% of GDP)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r cab_graph3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Current Account Balance 2000 - 2017 aggregated regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="Current account balance (% of GDP)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Current account balance (% of GDP)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Domestic credit to private sector (% of GDP)

Domestic credit to private sector refers to financial resources provided to the private sector by financial corporations, such as through loans, purchases of nonequity securities, and trade credits and other accounts receivable, that establish a claim for repayment. For some countries these claims include credit to public enterprises. The financial corporations include monetary authorities and deposit money banks, as well as other financial corporations where data are available (including corporations that do not accept transferable deposits but do incur such liabilities as time and savings deposits). Examples of other financial corporations are finance and leasing companies, money lenders, insurance corporations, pension funds, and foreign exchange companies.

Credit is an important link in money transmission; it finances production, consumption, and capital formation, which in turn affect economic activity. The data on domestic credit provided to the private sector are taken from the financial corporations survey (line 52D) of the International Monetary Fund's (IMF) International Financial Statistics or, when unavailable, from its depository survey (line 32D). The banking sector includes monetary authorities (the central bank) and deposit money banks, as well as other financial corporations where data are available (including institutions that do not accept transferable deposits but do incur such liabilities as time and savings deposits). Examples of other financial corporations are finance and leasing companies, money lenders, insurance corporations, pension funds, and foreign exchange companies.

Private sector development and investment - tapping private sector initiative and investment for socially useful purposes - are critical for poverty reduction. In parallel with public sector efforts, private investment, especially in competitive markets, has tremendous potential to contribute to growth. Private markets are the engine of productivity growth, creating productive jobs and higher incomes. And with government playing a complementary role of regulation, funding, and service provision, private initiative and investment can help provide the basic services and conditions that empower poor people - by improving health, education, and infrastructure.

Credit to the private sector may sometimes include credit to state-owned or partially state-owned enterprises.

```{r credito, echo=FALSE,warning=FALSE,fig.cap=table_captions("credito", "")}

# Goods and services expense (% of expense)

knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Domestic credit to private sector (% of GDP)" & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Domestic credit to private sector (% of GDP)")
```

```{r credito_graph1, echo=FALSE,warning=FALSE,fig.cap="Boxplot Domestic Credit to private sector 2000 - 2017"}
md %>% filter(`Series Name`=="Domestic credit to private sector (% of GDP)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Domestic credit to private sector (% of GDP)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Domestic credit to private sector (% of GDP)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

```{r credito_graph2, echo=FALSE,warning=FALSE,fig.cap="Trendline Domestic Credit to private sector 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Domestic credit to private sector (% of GDP)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Domestic credit to private sector (% of GDP)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r credito_graph3, echo=FALSE,warning=FALSE,results='hide',message=FALSE,,fig.cap="Trendline Domestic Credit to private sector 2000 - 2017 aggregated regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="Domestic credit to private sector (% of GDP)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Domestic credit to private sector (% of GDP)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Domestic credit to private sector by banks (% of GDP)

Domestic credit to private sector by banks refers to financial resources provided to the private sector by other depository corporations (deposit taking corporations except central banks), such as through loans, purchases of nonequity securities, and trade credits and other accounts receivable, that establish a claim for repayment. For some countries these claims include credit to public enterprises.

Credit is an important link in money transmission; it finances production, consumption, and capital formation, which in turn affect economic activity. The data on domestic credit provided to the private sector by banks are taken from the other depository corporations survey (line 22D) of the International Monetary Fund's (IMF) International Financial Statistics. The other depository corporations include all deposit taking corporations (deposit money banks) except monetary authorities (the central bank).

Private sector development and investment - tapping private sector initiative and investment for socially useful purposes - are critical for poverty reduction. In parallel with public sector efforts, private investment, especially in competitive markets, has tremendous potential to contribute to growth. Private markets are the engine of productivity growth, creating productive jobs and higher incomes. And with government playing a complementary role of regulation, funding, and service provision, private initiative and investment can help provide the basic services and conditions that empower poor people - by improving health, education, and infrastructure.

Credit to the private sector may sometimes include credit to state-owned or partially state-owned enterprises.

```{r creditbybanks, echo=FALSE,warning=FALSE,fig.cap=table_captions("creditbybanks", "")}
knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Domestic credit to private sector by banks (% of GDP)" & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Domestic credit to private sector by banks (% of GDP)")
```

```{r creditbybanks_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Credit to the private sector by banks (% of GDP) 2000 - 2017"}
md %>% filter(`Series Name`=="Domestic credit to private sector by banks (% of GDP)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Domestic credit to private sector by banks (% of GDP)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Domestic credit to private sector by banks (% of GDP)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

```{r creditbybanks_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Credit to the private sector by banks (% of GDP) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Domestic credit to private sector by banks (% of GDP)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Domestic credit to private sector by banks (% of GDP)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r creditbybanks_grp3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Credit to the private sector by banks (% of GDP) 2000 - 2017 aggregated regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="Domestic credit to private sector by banks (% of GDP)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Domestic credit to private sector by banks (% of GDP)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Exports of goods and services (% of GDP)

Exports of goods and services represent the value of all goods and other market services provided to the rest of the world. They include the value of merchandise, freight, insurance, transport, travel, royalties, license fees, and other services, such as communication, construction, financial, information, business, personal, and government services. They exclude compensation of employees and investment income (formerly called factor services) and transfer payments.

Gross domestic product (GDP) from the expenditure side is made up of household final consumption expenditure, general government final consumption expenditure, gross capital formation (private and public investment in fixed assets, changes in inventories, and net acquisitions of valuables), and net exports (exports minus imports) of goods and services. Such expenditures are recorded in purchaser prices and include net taxes on products.

Because policymakers have tended to focus on fostering the growth of output, and because data on production are easier to collect than data on spending, many countries generate their primary estimate of GDP using the production approach. Moreover, many countries do not estimate all the components of national expenditures but instead derive some of the main aggregates indirectly using GDP (based on the production approach) as the control total.

Data on exports and imports are compiled from customs reports and balance of payments data. Although the data from the payments side provide reasonably reliable records of cross-border transactions, they may not adhere strictly to the appropriate definitions of valuation and timing used in the balance of payments or corresponds to the change-of ownership criterion. This issue has assumed greater significance with the increasing globalization of international business. Neither customs nor balance of payments data usually capture the illegal transactions that occur in many countries. Goods carried by travelers across borders in legal but unreported shuttle trade may further distort trade statistics.

```{r exports, echo=FALSE,warning=FALSE,fig.cap=table_captions("exports", "")}
knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Exports of goods and services (% of GDP)"  & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Exports of goods and services (% of GDP)")
```


```{r exports_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Exports of goods and services (% of GDP) 2000 - 2017"}
md %>% filter(`Series Name`=="Exports of goods and services (% of GDP)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Exports of goods and services (% of GDP)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Exports of goods and services (% of GDP)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```


```{r exports_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Exports of goods and services (% of GDP) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Exports of goods and services (% of GDP)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Exports of goods and services (% of GDP)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```


```{r exports_grp3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Exports of goods and services (% of GDP) 2000 - 2017 aggregated regions and biggest countries"}

ggplot(data=md%>%filter(`Series Name`=="Exports of goods and services (% of GDP)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Exports of goods and services (% of GDP)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Exports of goods and services (annual % growth)

Annual growth rate of exports of goods and services based on constant local currency. Aggregates are based on constant 2010 U.S. dollars. Exports of goods and services represent the value of all goods and other market services provided to the rest of the world. They include the value of merchandise, freight, insurance, transport, travel, royalties, license fees, and other services, such as communication, construction, financial, information, business, personal, and government services. They exclude compensation of employees and investment income (formerly called factor services) and transfer payments.


```{r  exportsgrwt, echo=FALSE,warning=FALSE,fig.cap=table_captions("exportsgrwt", "")}
knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Exports of goods and services (annual % growth)" & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Exports of goods and services (annual % growth)")
```

```{r exportsgrw_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Exports of goods and services (annual growth) 2000 - 2017"}
md %>% filter(`Series Name`=="Exports of goods and services (annual % growth)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Exports of goods and services (annual % growth)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Exports of goods and services (annual % growth)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

```{r exportsgrw_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Exports of goods and services (annual growth) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Exports of goods and services (annual % growth)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Exports of goods and services (annual % growth)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r exportsgrw_grp3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Exports of goods and services (annual growth) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Exports of goods and services (annual % growth)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Exports of goods and services (annual % growth)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Food exports (% of merchandise exports)

Food comprises the commodities in SITC sections 0 (food and live animals), 1 (beverages and tobacco), and 4 (animal and vegetable oils and fats) and SITC division 22 (oil seeds, oil nuts, and oil kernels).

World Bank staff estimates through the WITS platform from the Comtrade database maintained by the United Nations Statistics Division.

The classification of commodity groups is based on the Standard International Trade Classification (SITC) revision 3.

Previous editions contained data based on the SITC revision 1. Data for earlier years in previous editions may differ because of the change in methodology. Concordance tables are available to convert data reported in one system to another.

Merchandise export shares may not sum to 100 percent because of unclassified trade.

```{r foodexpts, echo=FALSE,warning=FALSE,fig.cap=table_captions("foodexpts", "")}
knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Food exports (% of merchandise exports)"  & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Food exports (% of merchandise exports)")
```


```{r foodexpts_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Food exports (% of merchandise exports) 2000 - 2017"}
md %>% filter(`Series Name`=="Food exports (% of merchandise exports)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Food exports (% of merchandise exports)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Food exports (% of merchandise exports)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```


```{r foodexpts_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Food exports (% of merchandise exports) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Food exports (% of merchandise exports)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Food exports (% of merchandise exports)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r foodexpts_grp3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Food exports (% of merchandise exports) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Food exports (% of merchandise exports)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Food exports (% of merchandise exports)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Food imports (% of merchandise imports)

Merchandise import shares may not sum to 100 percent because of unclassified trade.


```{r foodimpts, echo=FALSE,warning=FALSE,fig.cap=table_captions("foodimpts", "")}
knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Food imports (% of merchandise imports)" & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Food imports (% of merchandise imports)")
```


```{r foodimpts_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Food imports (% of merchandise imports) 2000 - 2017"}
md %>% filter(`Series Name`=="Food imports (% of merchandise imports)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Food imports (% of merchandise imports)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Food imports (% of merchandise imports)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```


```{r foodimpts_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Food imports (% of merchandise imports) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Food imports (% of merchandise imports)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Food imports (% of merchandise imports)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```


```{r foodimpts_grp3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Food imports (% of merchandise imports) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Food imports (% of merchandise imports)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Food imports (% of merchandise imports)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Final consumption expenditure (% of GDP)

Final consumption expenditure (formerly total consumption) is the sum of household final consumption expenditure (private consumption) and general government final consumption expenditure (general government consumption). This estimate includes any statistical discrepancy in the use of resources relative to the supply of resources.

```{r fnlconsexp, echo=FALSE,warning=FALSE,fig.cap=table_captions("fnlconsexp", "")}
knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Final consumption expenditure (% of GDP)" & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Final consumption expenditure (% of GDP)")
```


```{r fnlconsexp_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Final consumption expenditure (% of GDP) 2000 - 2017"}
md %>% filter(`Series Name`=="Final consumption expenditure (% of GDP)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Final consumption expenditure (% of GDP)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Final consumption expenditure (% of GDP)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```


```{r fnlconsexp_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Final consumption expenditure (% of GDP) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Final consumption expenditure (% of GDP)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Final consumption expenditure (% of GDP)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```


```{r fnlconsexp_grp3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Final consumption expenditure (% of GDP) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Final consumption expenditure (% of GDP)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Final consumption expenditure (% of GDP)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Final consumption expenditure (annual % growth)

Average annual growth of final consumption expenditure based on constant local currency. Aggregates are based on constant 2010 U.S. dollars. Final consumption expenditure (formerly total consumption) is the sum of household final consumption expenditure (formerly private consumption) and general government final consumption expenditure (formerly general government consumption). This estimate includes any statistical discrepancy in the use of resources relative to the supply of resources.

```{r fnlconsexpgrw, echo=FALSE,warning=FALSE,fig.cap=table_captions("fnlconsexpgrw", "")}
knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Final consumption expenditure (annual % growth)" & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Final consumption expenditure (annual % growth)")
```


```{r fnlconsexpgrw_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Final consumption expenditure (annual % growth) 2000 - 2017"}
md %>% filter(`Series Name`=="Final consumption expenditure (annual % growth)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Final consumption expenditure (annual % growth)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Final consumption expenditure (annual % growth)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```


```{r fnlconsexpgrw_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Final consumption expenditure (annual % growth) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Final consumption expenditure (annual % growth)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Final consumption expenditure (annual % growth)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```


```{r fnlconsexpgrw_grp3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Final consumption expenditure (annual % growth) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Final consumption expenditure (annual % growth)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Final consumption expenditure (annual % growth)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Foreign direct investment, net inflows (% of GDP)

Foreign direct investment are the net inflows of investment to acquire a lasting management interest (10 percent or more of voting stock) in an enterprise operating in an economy other than that of the investor. It is the sum of equity capital, reinvestment of earnings, other long-term capital, and short-term capital as shown in the balance of payments. This series shows net inflows (new investment inflows less disinvestment) in the reporting economy from foreign investors, and is divided by GDP.

Data on equity flows are based on balance of payments data reported by the International Monetary Fund (IMF). Foreign direct investment (FDI) data are supplemented by the World Bank staff estimates using data from the United Nations Conference on Trade and Development (UNCTAD) and official national sources.

The internationally accepted definition of FDI (from the sixth edition of the IMF's Balance of Payments Manual [2009]), includes the following components: equity investment, including investment associated with equity that gives rise to control or influence; investment in indirectly influenced or controlled enterprises; investment in fellow enterprises; debt (except selected debt); and reverse investment. The Framework for Direct Investment Relationships provides criteria for determining whether cross-border ownership results in a direct investment relationship, based on control and influence. Distinguished from other kinds of international investment, FDI is made to establish a lasting interest in or effective management control over an enterprise in another country. A lasting interest in an investment enterprise typically involves establishing warehouses, manufacturing facilities, and other permanent or long-term organizations abroad. Direct investments may take the form of greenfield investment, where the investor starts a new venture in a foreign country by constructing new operational facilities; joint venture, where the investor enters into a partnership agreement with a company abroad to establish a new enterprise; or merger and acquisition, where the investor acquires an existing enterprise abroad. The IMF suggests that investments should account for at least 10 percent of voting stock to be counted as FDI. In practice many countries set a higher threshold. Many countries fail to report reinvested earnings, and the definition of long-term loans differs among countries. BoP refers to Balance of Payments.

FDI data do not give a complete picture of international investment in an economy. Balance of payments data on FDI do not include capital raised locally, an important source of investment financing in some developing countries. In addition, FDI data omit nonequity cross-border transactions such as intra-unit flows of goods and services.

The volume of global private financial flows reported by the World Bank generally differs from that reported by other sources because of differences in sources, classification of economies, and method used to adjust and disaggregate reported information. In addition, particularly for debt financing, differences may also reflect how some installments of the transactions and certain offshore issuances are treated.

Data on equity flows are shown for all countries for which data are available.

**Note: Data starting from 2005 are based on the sixth edition of the IMF's Balance of Payments Manual (BPM6).**

```{r frgdrinvnetflws, echo=FALSE,warning=FALSE,fig.cap=table_captions("frgdrinvnetflws", "")}
knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Foreign direct investment, net inflows (% of GDP)" & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(sd(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Foreign direct investment, net inflows (% of GDP)")
```


```{r frgdrinvnetflws_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Foreign direct investment, net inflows (% of GDP) 2000 - 2017"}
md %>% filter(`Series Name`=="Foreign direct investment, net inflows (% of GDP)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot(outlier.shape = "") + geom_jitter(width=0.1,alpha=0.2) + labs(y="Foreign direct investment, net inflows (% of GDP)",x="Country Code") + theme_bw(base_size = 8)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Foreign direct investment, net inflows (% of GDP)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

```{r frgdrinvnetflws_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Foreign direct investment, net inflows (% of GDP) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Foreign direct investment, net inflows (% of GDP)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Foreign direct investment, net inflows (% of GDP)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r frgdrinvnetflws_grp3,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Foreign direct investment, net inflows (% of GDP) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Foreign direct investment, net inflows (% of GDP)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Foreign direct investment, net inflows (% of GDP)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

# Goverment

## Expense (% of GDP)

Expense is cash payments for operating activities of the government in providing goods and services. It includes compensation of employees (such as wages and salaries), interest and subsidies, grants, social benefits, and other expenses such as rent and dividends.

## Limitations and exceptions

For most countries central government finance data have been consolidated into one account, but for others only budgetary central government accounts are available. Countries reporting budgetary data are noted in the country metadata. Because budgetary accounts may not include all central government units (such as social security funds), they usually provide an incomplete picture. In federal states the central government accounts provide an incomplete view of total public finance.

```{r opexp,echo=FALSE,warning=FALSE,fig.cap=table_captions("opexp", "")}
knitr::kable(statis%>%filter(`Series Name`=="Expense (% of GDP)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Expense is cash payments for operating activities of the government in providing goods and services '%'")
```

\newpage

```{r opexp_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Expense (% of GDP) 2000 - 2017"}
md %>% filter(`Series Name`=="Expense (% of GDP)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Expense (% of GDP)",x="Country Code") + theme_bw(base_size = 8)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Expense (% of GDP)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```



```{r opexp_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Expense (% of GDP) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Expense (% of GDP)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Expense (% of GDP)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Goods and services expense (% of expense)

Goods and services include all government payments in exchange for goods and services used for the production of market and nonmarket goods and services. Own-account capital formation is excluded.



```{r gse,echo=FALSE,warning=FALSE,fig.cap=table_captions("gse", "")}

# Goods and services expense (% of expense)

knitr::kable(statis%>%filter(`Series Name`=="Goods and services expense (% of expense)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Goods and services expense (% of expense)")
```



```{r gse_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Goods and services expense (% of expense) 2000 - 2017"}
md %>% filter(`Series Name`=="Goods and services expense (% of expense)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Goods and services expense (% of expense)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Goods and services expense (% of expense)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

```{r gse_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Goods and services expense (% of expense) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Goods and services expense (% of expense)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Goods and services expense (% of expense)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Interest payments (% of expense)

Interest payments include interest payments on government debt--including long-term bonds, long-term loans, and other debt instruments--to domestic and foreign residents.

```{r ipe,echo=FALSE,warning=FALSE,fig.cap=table_captions("ipe", "")}
knitr::kable(statis%>%filter(`Series Name`=="Interest payments (% of expense)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Interest payments (% of expense)")
```

```{r ipe_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Interest payments (% of expense) 2000 - 2017"}
md %>% filter(`Series Name`=="Interest payments (% of expense)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Interest payments (% of expense)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Interest payments (% of expense)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

## Benefit incidence of social insurance programs to poorest quintile (% of total social insurance benefits)

Benefit incidence of social insurance programs to poorest quintile shows the percentage of total social insurance benefits received by the poorest 20% of the population. Social insurance programs include old age contributory pensions (including survivors and disability) and social security and health insurance benefits (including occupational injury benefits, paid sick leave, maternity and other social insurance). Estimates include both direct and indirect beneficiaries.

When interpreting ASPIRE performance indicators based on household surveys, it is important to note that the extent to which information on specific transfers and programs is captured in the household surveys can vary a lot across countries. Moreover, household surveys do not capture the universe of social protection programs in the country, in best practice cases just the largest programs.  As a consequence, ASPIRE indicators are not fully comparable across program categories and countries; however, they provide approximate measures of social protection systems performance.  In addition, there may be cases where ASPIRE performance indicators differ from official WB country reports as ASPIRE indicators are based on a first level analysis of original survey data  and unified methodology that does not necessarily reflect country-specific knowledge and in depth country analysis relying on administrative program level data and/or imputations.

```{r benefitsincidence,echo=FALSE,warning=FALSE,fig.cap=table_captions("benefitsincidence", "")}
knitr::kable(statis%>%filter(`Series Name`=="Benefit incidence of social insurance programs to poorest quintile (% of total social insurance benefits)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Benefit incidence (% of total social insurance benefits)")
```

```{r beninc_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Interest payments (% of expense) 2000 - 2017"}
md %>% filter(`Series Name`=="Benefit incidence of social insurance programs to poorest quintile (% of total social insurance benefits)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Ben Inc of Soc Ins Prog to poorest quintile") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Benefit incidence of social insurance programs to poorest quintile (% of total social insurance benefits)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

```{r beninc_grp2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Interest payments (% of expense) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Benefit incidence of social insurance programs to poorest quintile (% of total social insurance benefits)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Incidence of social insurance programs to poorest quintile",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Ease of doing business index (1=most business-friendly regulations)

Ease of doing business ranks economies from 1 to 190, with first place being the best. A high ranking (a low numerical rank) means that the **regulatory environment** is conducive to business operation. The index averages the country's percentile rankings on 10 topics covered in the World Bank's Doing Business. The ranking on each topic is the simple average of the percentile rankings on its component indicators.

Data are collected by the World Bank with a standardized survey that uses a simple business case to ensure comparability across economies and over time - with assumptions about the legal form of the business, its size, its location, and nature of its operation. Surveys are administered through more than 9,000 local experts, including lawyers, business consultants, accountants, freight forwarders, government officials, and other professionals who routinely administer or advise on legal and regulatory requirements.

The economic health of a country is measured not only in macroeconomic terms but also by other factors that shape daily economic activity such as laws, regulations, and institutional arrangements. The data measure business regulation, gauge regulatory outcomes, and measure the extent of legal protection of property, the flexibility of employment regulation, and the tax burden on businesses.

The fundamental premise of this data is that economic activity requires good rules and regulations that are efficient, accessible to all who need to use them, and simple to implement. Thus sometimes there is more emphasis on more regulation, such as stricter disclosure requirements in related-party transactions, and other times emphasis is on for simplified regulations, such as a one-stop shop for completing business startup formalities.

Entrepreneurs may not be aware of all required procedures or may avoid legally required procedures altogether. But where regulation is particularly onerous, levels of informality are higher, which comes at a cost: firms in the informal sector usually grow more slowly, have less access to credit, and employ fewer workers - and those workers remain outside the protections of labor law. The indicator can help policymakers understand the business environment in a country and - along with information from other sources such as the World Bank's Enterprise Surveys - provide insights into potential areas of reform.
The Doing Business methodology has limitations that should be considered when interpreting the data. First, the data collected refer to businesses in the economy's largest city and may not represent regulations in other locations of the economy. To address this limitation, subnational indicators are being collected for selected economies. These subnational studies point to significant differences in the speed of reform and the ease of doing business across cities in the same economy. Second, the data often focus on a specific business form - generally a limited liability company of a specified size - and may not represent regulation for other types of businesses such as sole proprietorships. Third, transactions described in a standardized business case refer to a specific set of issues and may not represent the full set of issues a business encounters. Fourth, the time measures involve an element of judgment by the expert respondents. When sources indicate different estimates, the Doing Business time indicators represent the median values of several responses given under the assumptions of the standardized case. Fifth, the methodology assumes that a business has full information on what is required and does not waste time when completing procedures.

Data are presented for the survey year instead of publication year. Data before 2013 are not comparable with data from 2013 onward due to methodological changes.

```{r easetodobusinessafter_2013,echo=FALSE,warning=FALSE,fig.cap=table_captions("easetodobusinessafter_2013", "")}

# Goods and services expense (% of expense)

knitr::kable(md%>%mutate(fecha=as.integer(Time))%>%filter(`Series Name`=="Ease of doing business index (1=most business-friendly regulations)" & fecha >=2013 & !is.na(value) )%>%group_by(`Country Name`, Continent)%>%dplyr::summarise(Mean=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(mean(value,na.rm = TRUE),big.mark=",",scientific=FALSE,digits=2))%>% ungroup() %>%select(-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Ease of doing business index (1=most business-friendly regulations)")
```


```{r etb2013_grp1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Ease of doing business index (1=most business-friendly regulations) 2000 - 2017"}
md %>% filter(`Series Name`=="Ease of doing business index (1=most business-friendly regulations)" & !is.na(md$value)) %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Index (1=most business-friendly regulations)") + theme_bw(base_size = 10)+ theme(axis.text.x = element_text(angle = 90, hjust = 1))  + geom_hline(yintercept=md %>% filter(`Series Name`=="Ease of doing business index (1=most business-friendly regulations)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

\newpage

# Health

## Domestic general government health expenditure (% of GDP)

Share of current health expenditures funded from domestic public sources for health.  Domestic public sources include domestic revenue as internal transfers and grants, transfers, subsidies to voluntary health insurance beneficiaries, non-profit institutions serving households (NPISH) or enterprise financing schemes as well as compulsory prepayment and social health insurance contributions. They do not include external resources spent by governments on health.

The health expenditure estimates have been prepared by the World Health Organization under the framework of the System of Health Accounts 2011 (SHA 2011).  The Health SHA 2011 tracks all health spending in a given country over a defined period of time regardless of the entity or institution that financed and managed that spending. It generates consistent and comprehensive data on health spending in a country, which in turn can contribute to evidence-based policy-making.

```{r healt_gdp,echo=FALSE,warning=FALSE,fig.cap=table_captions("healt_gdp", "")}

# Goods and services expense (% of expense)

knitr::kable(statis%>%filter(`Series Name`=="Domestic general government health expenditure (% of GDP)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Domestic general government health expenditure (% of GDP)")
```

```{r healthgdpgraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Domestic general government health expenditure (% of GDP) 2000 - 2017"}
md %>% filter(`Series Name`=="Domestic general government health expenditure (% of GDP)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Domestic Gov Health Exp (% of GDP)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Domestic general government health expenditure (% of GDP)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red")
```

\newpage

## Domestic general government health expenditure (% of general government expenditure)

Share of current health expenditures funded from domestic public sources for health.  Domestic public sources include domestic revenue as internal transfers and grants, transfers, subsidies to voluntary health insurance beneficiaries, non-profit institutions serving households (NPISH) or enterprise financing schemes as well as compulsory prepayment and social health insurance contributions. They do not include external resources spent by governments on health.

## Statistical concept and methodology

The health expenditure estimates have been prepared by the World Health Organization under the framework of the System of Health Accounts 2011 (SHA 2011).  The Health SHA 2011 tracks all health spending in a given country over a defined period of time regardless of the entity or institution that financed and managed that spending. It generates consistent and comprehensive data on health spending in a country, which in turn can contribute to evidence-based policy-making.

```{r healt_expense,echo=FALSE,warning=FALSE,fig.cap=table_captions("healt_expense", "")}

knitr::kable(statis%>%filter(`Series Name`=="Domestic general government health expenditure (% of general government expenditure)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Domestic general government health expenditure (% of general government expenditure)")
```



```{r healthexpensegraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Domestic general government health expenditure (% of general government expenditure) 2000 - 2017"}
md %>% filter(`Series Name`=="Domestic general government health expenditure (% of general government expenditure)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Domestic Gov Health Exp (% Gov Exp)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Domestic general government health expenditure (% of general government expenditure)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") 
```

\newpage

## Births attended by skilled health staff (% of total)

Births attended by skilled health staff are the percentage of deliveries attended by personnel trained to give the necessary supervision, care, and advice to women during pregnancy, labor, and the postpartum period; to conduct deliveries on their own; and to care for newborns.

Reproductive health is a state of physical and mental well-being in relation to the reproductive system and its functions and processes. Means of achieving reproductive health include education and services during pregnancy and childbirth, safe and effective contraception, and prevention and treatment of sexually transmitted diseases. Complications of pregnancy and childbirth are the leading cause of death and disability among women of reproductive age in developing countries.

```{r attended_births,echo=FALSE,warning=FALSE,fig.cap=table_captions("attended_births", "")}

knitr::kable(statis%>%filter(`Series Name`=="Births attended by skilled health staff (% of total)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Births attended by skilled health staff (% of total)")
```

```{r attendedbirths_graph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Births attended by skilled health staff (% of total) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Births attended by skilled health staff (% of total)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Births attended by skilled health staff (% of total)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

```{r attendedbirths_graph_AGRR,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Births attended by skilled health staff (% of total) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Births attended by skilled health staff (% of total)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia") & !is.na(md$value))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Births attended by skilled health staff (% of total)",x="Time") + theme_bw(base_size = 10)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Hospital beds (per 1,000 people)


Hospital beds include inpatient beds available in public, private, general, and specialized hospitals and rehabilitation centers. In most cases beds for both acute and chronic care are included.

```{r bed_1000,echo=FALSE,warning=FALSE,fig.cap=table_captions("bed_1000", "")}
knitr::kable(statis%>%filter(`Series Name`=="Hospital beds (per 1,000 people)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Hospital beds (per 1,000 people)")
#%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0))
``` 




```{r bed1000graph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Hospital beds (per 1,000 people) 2000 - 2017"}
md %>% filter(`Series Name`=="Hospital beds (per 1,000 people)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Hospital beds (per 1,000 people)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Hospital beds (per 1,000 people)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```

\newpage

# Demographics

## Population, total

```{r population,echo=FALSE,warning=FALSE,fig.cap=table_captions("population", "")}

knitr::kable(statis%>%filter(`Series Name`=="Population, total") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Population, total")
```



```{r populationgraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Population, total 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Population, total" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(label = unit_format(unit = "M", scale = 1e-6)) + labs(y="Population",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
```

```{r population_graph_aggr,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Population, total regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Population, total" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(label = unit_format(unit = "M", scale = 1e-6)) + labs(y="Population",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```


```{r populationmale,echo=FALSE,warning=FALSE,fig.cap=table_captions("populationmale", "")}
male<-statis%>%filter(`Series Name`=="Population, male (% of total)") %>% mutate(`Male Mean`=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent,-Mean,-SD)%>%arrange(`Country Name`)
female<-statis%>%filter(`Series Name`=="Population, female (% of total)") %>% mutate(`Fenale Mean`=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent,-Mean,-SD)%>%arrange(`Country Name`)
    
knitr::kable(inner_join(male,female,by=c("Country Name")), align = c('l','c','c'), caption = "Male and Female, %")
```

\newpage

## Life expectancy at birth, total (years)

```{r lifeexpectancy,echo=FALSE,warning=FALSE,fig.cap=table_captions("lifeexpectancy", "")}

knitr::kable(statis%>%filter(`Series Name`=="Life expectancy at birth, total (years)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','c','c'), caption = "Life expectancy at birth (years)")
```



```{r lifeexpectancygraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Life expectancy at birth, total (years) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Life expectancy at birth, total (years)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Life expectancy at birth (years)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```



```{r lifeexpectancy_graph_aggr,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Life expectancy at birth, total (years) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Life expectancy at birth, total (years)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::comma) + labs(y="Life expectancy at birth (years)",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Fertility rate, total (births per woman)

```{r fertilityrate,echo=FALSE,warning=FALSE,fig.cap=table_captions("fertilityrate", "")}

knitr::kable(statis%>%filter(`Series Name`=="Fertility rate, total (births per woman)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Fertility rate (births per woman)")
```



```{r fertilityrategraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Fertility rate, total (births per woman) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Fertility rate, total (births per woman)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Fertility rate (births per woman)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```



```{r fertilityrate_graph_aggr,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Fertility rate, total (births per woman) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Fertility rate, total (births per woman)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Fertility rate (births per woman)",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Age dependency ratio, old (% of working-age population)

Age dependency ratio, old, is the ratio of older dependents--people older than 64--to the working-age population--those ages 15-64. Data are shown as the proportion of dependents per 100 working-age population.

Dependency ratios capture variations in the proportions of children, elderly people, and working-age people in the population that imply the dependency burden that the working-age population bears in relation to children and the elderly. But dependency ratios show only the age composition of a population, not economic dependency. Some children and elderly people are part of the labor force, and many working-age people are not.

```{r agedependencyrateold,warning=FALSE,echo=FALSE,warning=FALSE,fig.cap=table_captions("agedependencyrateold", "")}

knitr::kable(statis%>%filter(`Series Name`=="Age dependency ratio, old (% of working-age population)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Age dependency ratio, old (% of working-age population)")
```



```{r agedependencyrateoldgraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Age dependency ratio, old (% of working-age population) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Age dependency ratio, old (% of working-age population)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Age dependency ratio, old (% of working-age population)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```



```{r gedependencyrateold_graph_aggr,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Age dependency ratio, old (% of working-age population) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Age dependency ratio, old (% of working-age population)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Age dependency ratio, old (% of working-age population)",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Age dependency ratio, young (% of working-age population)

Age dependency ratio, young, is the ratio of younger dependents--people younger than 15--to the working-age population--those ages 15-64. Data are shown as the proportion of dependents per 100 working-age population.

```{r agedependencyrateyoung,echo=FALSE,warning=FALSE,fig.cap=table_captions("agedependencyrateold", "")}

knitr::kable(statis%>%filter(`Series Name`=="Age dependency ratio, young (% of working-age population)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Age dependency ratio, young (% of working-age population)")
```



```{r agedependencyrateyounggraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Age dependency ratio, young (% of working-age population) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Age dependency ratio, young (% of working-age population)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Age dependency ratio, young (% of working-age population)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))+scale_y_continuous(labels = scales::comma)
```



```{r gedependencyrateyoung_graph_aggr,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Age dependency ratio, young (% of working-age population) regions and biggest countries 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Age dependency ratio, young (% of working-age population)" & (`Country Name` =="United States" | `Country Name` =="China" | `Country Name` =="Japan" | `Country Name` =="European Union" | `Country Name` =="Latin America & Caribbean" | `Country Name` =="Middle East & North Africa" | `Country Name` =="OECD members" | `Country Name` =="South Asia (IDA & IBRD)" | `Country Name` =="World" | `Country Name` =="Sub-Saharan Africa" | `Country Name` =="South Asia"))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = 1)+facet_wrap(~`Country Name`, scales = "free",nrow=4)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Age dependency ratio, young (% of working-age population)",x="Time") + theme_bw(base_size = 8)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Poverty headcount ratio at national poverty lines (% of population)

National poverty headcount ratio is the percentage of the population living below the national poverty lines. National estimates are based on population-weighted subgroup estimates from household surveys.

Poverty headcount ratio among the population is measured based on national (i.e. country-specific) poverty lines. A country may have a unique national poverty line or separate poverty lines for rural and urban areas, or for different geographic areas to reflect differences in the cost of living or sometimes to reflect differences in diets and consumption baskets.

Poverty estimates at national poverty lines are computed from household survey data collected from nationally representative samples of households. These data must contain sufficiently detailed information to compute a comprehensive estimate of total household income or consumption (including consumption or income from own production), from which it is possible to construct a correctly weighted distribution of per capita consumption or income.

National poverty lines are the benchmark for estimating poverty indicators that are consistent with the country's specific economic and social circumstances. National poverty lines reflect local perceptions of the level and composition of consumption or income needed to be non-poor. The perceived boundary between poor and non-poor typically rises with the average income of a country and thus does not provide a uniform measure for comparing poverty rates across countries. While poverty rates at national poverty lines should not be used for comparing poverty rates across countries, they are appropriate for guiding and monitoring the results of country-specific national poverty reduction strategies.

Almost all national poverty lines are anchored to the cost of a food bundle - based on the prevailing national diet of the poor - that provides adequate nutrition for good health and normal activity, plus an allowance for nonfood spending. National poverty lines must be adjusted for inflation between survey years to remain constant in real terms and thus allow for meaningful comparisons of poverty over time. Because diets and consumption baskets change over time, countries periodically recalculate the poverty line based on new survey data. In such cases the new poverty lines should be deflated to obtain comparable poverty estimates from earlier years. The data is based on the two most recent years for which survey data are available.

Survey year is the year in which the underlying household survey data were collected or, when the data collection period bridged two calendar years, the year in which most of the data were collected.

```{r headcountratiopoverty,echo=FALSE,warning=FALSE,fig.cap=table_captions("headcountratiopoverty", "")}

knitr::kable(statis%>%filter(`Series Name`=="Poverty headcount ratio at national poverty lines (% of population)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Poverty (% of population")
#%>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=0),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=0))
```


```{r povertyheadcountgraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Poverty headcount ratio at national poverty lines (% of population) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Poverty headcount ratio at national poverty lines (% of population)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Poverty headcount (% of population)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```




\newpage


## Access to electricity (% of population)

```{r accesstoelectricity,echo=FALSE,warning=FALSE,fig.cap=table_captions("accesstoelectricity", "")}

knitr::kable(statis%>%filter(`Series Name`=="Access to electricity (% of population)") %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Access to electricity (% of population)")
```

```{r accesstoelectricitygraph,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Access to electricity (% of population) 2000 - 2017"}
md %>% filter(`Series Name`=="Access to electricity (% of population)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Access to electricity (% of population)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Access to electricity (% of population)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```


## Educational attainment, at least completed primary, population 25+ years, total (%) (cumulative)

The percentage of population ages 25 and over that attained or completed primary education.

It is calculated by dividing the number of population **ages 25 and older** who attained or completed primary education by the total population of the same age group and multiplying by 100. The number 0 means zero or small enough that the number would round to zero. 

Data are collected by the UNESCO Institute for Statistics mainly from national population census, household survey, and labour force survey. All the data are mapped to the International Standard Classification of Education (ISCED) to ensure the comparability of education programs at the international level. The current version was formally adopted by UNESCO Member States in 2011.

A relative high concentration of the adult population in a given level of education reflects the capacity of the educational system in the corresponding level of education. Educational attainment is closely related to the skills and competencies of a country's population, and could be seen as a proxy of both the quantitative and qualitative aspects of the stock of human capital.

Caution is required when using this indicator for cross-country comparison, since the countries do not always classify degrees and qualifications at the same International Standard Classification of Education (ISCED) levels, even if they are received at roughly the same age or after a similar number of years of schooling. Also, certain educational programmes and study courses cannot be easily classified according to ISCED. This indicator only measures educational attainment in terms of level of education attained, i.e. years of schooling, and do not necessarily reveal the quality of the education (learning achievement and other impacts).

Data retrieved via API in March 2019. For detailed information on the observation level (e.g. National Estimation, UIS Estimation, or Category not applicable), please visit UIS.Stat (http://data.uis.unesco.org/).

\newpage

```{r educational25prim,echo=FALSE,warning=FALSE,fig.cap=table_captions("educational25prim", "")}

knitr::kable(statis%>%filter(`Series Name`=="Educational attainment, at least completed primary, population 25+ years, total (%) (cumulative)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Educational attainment, at least completed primary, population 25+ years, total (%) (cumulative)")
```

```{r educational25primgraph1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Educational attainment, at least completed primary, population 25+ years, total (%) (cumulative)"}
md %>% filter(`Series Name`=="Educational attainment, at least completed primary, population 25+ years, total (%) (cumulative)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Population 25+ years (% of total) (cumulative)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Educational attainment, at least completed primary, population 25+ years, total (%) (cumulative)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```



```{r educational25primgraph2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Educational attainment, at least completed primary, population 25+ years, total (%) (cumulative) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Educational attainment, at least completed primary, population 25+ years, total (%) (cumulative)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Population 25+ years (% of total) (cumulative)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```





\newpage

## Educational attainment, at least completed lower secondary, population 25+, total (%) (cumulative)

The percentage of population ages 25 and over that attained or completed lower secondary education.

It is calculated by dividing the number of population **ages 25 and older** who attained or completed lower secondary education by the total population of the same age group and multiplying by 100. The number 0 means zero or small enough that the number would round to zero. 

Data are collected by the UNESCO Institute for Statistics mainly from national population census, household survey, and labour force survey. All the data are mapped to the International Standard Classification of Education (ISCED) to ensure the comparability of education programs at the international level. The current version was formally adopted by UNESCO Member States in 2011.

```{r educational25sec,echo=FALSE,warning=FALSE,fig.cap=table_captions("educational25sec", "")}

knitr::kable(statis%>%filter(`Series Name`=="Educational attainment, at least completed lower secondary, population 25+, total (%) (cumulative)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Educational attainment, at least completed lower secondary, population 25+ years, total (%) (cumulative)")
```

```{r educational25secgraph1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Educational attainment, at least completed lower secondary, population 25+, total (%) (cumulative)"}
md %>% filter(`Series Name`=="Educational attainment, at least completed lower secondary, population 25+, total (%) (cumulative)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Population 25+ years (% of total) (cumulative)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Educational attainment, at least completed lower secondary, population 25+, total (%) (cumulative)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```



```{r educational25secgraph2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Educational attainment, at least completed lower secondary, population 25+, total (%) (cumulative) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Educational attainment, at least completed lower secondary, population 25+, total (%) (cumulative)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Population 25+ years (% of total) (cumulative)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Educational attainment, at least completed post-secondary, population 25+, total (%) (cumulative)

The percentage of population ages 25 and over that attained or completed post-secondary non-tertiary education.

It is calculated by dividing the number of population **ages 25 and older** who attained or completed post-secondary non-tertiary education by the total population of the same age group and multiplying by 100. The number 0 means zero or small enough that the number would round to zero. 

Data are collected by the UNESCO Institute for Statistics mainly from national population census, household survey, and labour force survey. All the data are mapped to the International Standard Classification of Education (ISCED) to ensure the comparability of education programs at the international level. The current version was formally adopted by UNESCO Member States in 2011.

```{r educational25sectop,echo=FALSE,warning=FALSE,fig.cap=table_captions("educational25sectop", "")}

knitr::kable(statis%>%filter(`Series Name`=="Educational attainment, at least completed post-secondary, population 25+, total (%) (cumulative)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Educational attainment, at least completed post-secondary secondary, population 25+ years, total (%) (cumulative)")
```

```{r educational25sectopgraph1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Educational attainment, at least completed post-secondary, population 25+, total (%) (cumulative)"}
md %>% filter(`Series Name`=="Educational attainment, at least completed post-secondary, population 25+, total (%) (cumulative)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Population 25+ years (% of total) (cumulative)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Educational attainment, at least completed post-secondary, population 25+, total (%) (cumulative)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```



```{r educational25sectopgraph2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Educational attainment, at least completed post-secondary, population 25+, total (%) (cumulative) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Educational attainment, at least completed post-secondary, population 25+, total (%) (cumulative)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Population 25+ years (% of total) (cumulative)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative)

The percentage of population ages 25 and over that attained or completed Bachelor's or equivalent.

It is calculated by dividing the number of population **ages 25 and older** who attained or completed Bachelor's or equivalent by the total population of the same age group and multiplying by 100. The number 0 means zero or small enough that the number would round to zero. 

Data are collected by the UNESCO Institute for Statistics mainly from national population census, household survey, and labour force survey. All the data are mapped to the International Standard Classification of Education (ISCED) to ensure the comparability of education programs at the international level. The current version was formally adopted by UNESCO Member States in 2011.


```{r educational25bac,echo=FALSE,warning=FALSE,fig.cap=table_captions("educational25bac", "")}

knitr::kable(statis%>%filter(`Series Name`=="Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative)")
```

```{r educational25bacgraph1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative)"}
md %>% filter(`Series Name`=="Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Population 25+ years (% of total) (cumulative)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```



```{r educational25bacgraph2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Educational attainment, at least Bachelor's or equivalent, population 25+, total (%) (cumulative)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Population 25+ years (% of total) (cumulative)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```


\newpage

## Educational attainment, at least Master's or equivalent, population 25+, total (%) (cumulative)

The percentage of population ages 25 and over that attained or completed Master's or equivalent.

It is calculated by dividing the number of population **ages 25 and older** who attained or completed Master's or equivalent by the total population of the same age group and multiplying by 100. The number 0 means zero or small enough that the number would round to zero. 

Data are collected by the UNESCO Institute for Statistics mainly from national population census, household survey, and labour force survey. All the data are mapped to the International Standard Classification of Education (ISCED) to ensure the comparability of education programs at the international level. The current version was formally adopted by UNESCO Member States in 2011.


```{r educational25mas,echo=FALSE,warning=FALSE,fig.cap=table_captions("educational25mas", "")}

knitr::kable(statis%>%filter(`Series Name`=="Educational attainment, at least Master's or equivalent, population 25+, total (%) (cumulative)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Educational attainment, at least Master's or equivalent, population 25+, total (%) (cumulative)")
```

```{r educational25masgraph1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Educational attainment, at least Master's or equivalent, population 25+, total (%) (cumulative)"}
md %>% filter(`Series Name`=="Educational attainment, at least Master's or equivalent, population 25+, total (%) (cumulative)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Population 25+ years (% of total) (cumulative)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Educational attainment, at least Master's or equivalent, population 25+, total (%) (cumulative)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```



```{r educational25masgraph2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Educational attainment, at least Master's or equivalent, population 25+, total (%) (cumulative) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Educational attainment, at least Master's or equivalent, population 25+, total (%) (cumulative)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::comma) + labs(y="Population 25+ years (% of total) (cumulative)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```

\newpage

## Educational attainment, Doctoral or equivalent, population 25+, total (%) (cumulative)

The percentage of population ages 25 and over that attained or completed Doctoral or equivalent.
It is calculated by dividing the number of population **ages 25 and older** who attained or completed Doctoral or equivalent by the total population of the same age group and multiplying by 100. The number 0 means zero or small enough that the number would round to zero. 

Data are collected by the UNESCO Institute for Statistics mainly from national population census, household survey, and labour force survey. All the data are mapped to the International Standard Classification of Education (ISCED) to ensure the comparability of education programs at the international level. The current version was formally adopted by UNESCO Member States in 2011.

```{r educational25doc,echo=FALSE,warning=FALSE,fig.cap=table_captions("educational25doc", "")}

knitr::kable(statis%>%filter(`Series Name`=="Educational attainment, Doctoral or equivalent, population 25+, total (%) (cumulative)"&!is.na(Mean)) %>% mutate(Mean=prettyNum(Mean,big.mark=",",scientific=FALSE,digits=2),SD=prettyNum(SD,big.mark=",",scientific=FALSE,digits=2)) %>% ungroup() %>%select(-`Series Name`,-Continent)%>%arrange(`Country Name`), align = c('l','r','r'), caption = "Educational attainment, Doctoral or equivalent, population 25+, total (%) (cumulative)")
```

```{r educational25docgraph1,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Boxplot Educational attainment, Doctoral or equivalent, population 25+, total (%) (cumulative)"}
md %>% filter(`Series Name`=="Educational attainment, Doctoral or equivalent, population 25+, total (%) (cumulative)") %>% ggplot(aes(x= `Country Code`,y=value, fill=Continent)) +  geom_boxplot() + geom_jitter(width=0.1,alpha=0.2) + labs(y="Population 25+ years (% of total) (cumulative)",x="Country Code") + theme_bw(base_size = 8)  + theme(axis.text.x = element_text(angle = 90, hjust = 1)) + geom_hline(yintercept=md %>% filter(`Series Name`=="Educational attainment, Doctoral or equivalent, population 25+, total (%) (cumulative)")%>%select(value)%>%group_by()%>%summarise(n=mean(value,na.rm=TRUE))%>%as.double(), linetype="dashed", color = "red") #
```



```{r educational25docgraph2,warning=FALSE,results='hide',message=FALSE,fig.keep='all',fig.cap="Trendline Educational attainment, Doctoral or equivalent, population 25+, total (%) (cumulative) 2000 - 2017"}

ggplot(data=md%>%filter(`Series Name`=="Educational attainment, Doctoral or equivalent, population 25+, total (%) (cumulative)" & (`Country Name` !="European Union" & `Country Name` !="Latin America & Caribbean" & `Country Name` !="Middle East & North Africa" & `Country Name` !="OECD members" & `Country Name` !="South Asia (IDA & IBRD)"& `Country Name` !="World"& `Country Name` !="Sub-Saharan Africa"& `Country Name` !="South Asia" & !is.na(md$value)))%>% mutate(Time=(as.integer(Time)-2000)),aes(x=Time,y=value))+geom_smooth(size = .5)+geom_point(mapping = aes(color=Continent),size = .5)+facet_wrap(~`Country Name`, scales = "free",nrow=5)+scale_y_continuous(labels = scales::number_format(accuracy = 0.01)) + labs(y="Population 25+ years (% of total) (cumulative)",x="Time") + theme_bw(base_size = 5)+scale_x_continuous(limits = c(0, 16))
#+ ggtitle(expression(atop("Relacion Edad vs. Puntos Promedio por Cuenta", atop(italic("Todos los paises y todos los productos bancarios"), ""))))
```


